[
    {
        "id": "ee81cc611986e56f",
        "type": "tab",
        "label": "InputRead",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "6910828fa524c0ad",
        "type": "tab",
        "label": "Alarmas",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2810139c92bd41d8",
        "type": "tab",
        "label": "ReciveGasControl",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "8389501e8b369815",
        "type": "tab",
        "label": "ReciveCleanerDisplay",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "a9cd65b1c67ffc15",
        "type": "tab",
        "label": "AnalogSet",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "3b30c3f369fbd9c7",
        "type": "tab",
        "label": "CreateTiket",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "1cc0ca82ef3a0a9b",
        "type": "tab",
        "label": "LoadConfig",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "8b7a3cc1bad4cf4b",
        "type": "tab",
        "label": "DatabaseManager",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "619addbf2da107aa",
        "type": "tab",
        "label": "MainDisplay",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b29ed1d9bf2c7ea9",
        "type": "tab",
        "label": "Calculo-flujo",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "33c28a10b022eebb",
        "type": "tab",
        "label": "Output_write",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c11465eb77fd5a0c",
        "type": "modbus-client",
        "name": "V560",
        "clienttype": "serial",
        "bufferCommands": true,
        "stateLogEnabled": false,
        "queueLogEnabled": false,
        "failureLogEnabled": true,
        "tcpHost": "127.0.0.1",
        "tcpPort": "502",
        "tcpType": "DEFAULT",
        "serialPort": "/dev/ttyUSB0",
        "serialType": "RTU-BUFFERD",
        "serialBaudrate": "115200",
        "serialDatabits": "8",
        "serialStopbits": "1",
        "serialParity": "none",
        "serialConnectionDelay": "100",
        "serialAsciiResponseStartDelimiter": "0x3A",
        "unit_id": 1,
        "commandDelay": 1,
        "clientTimeout": 1000,
        "reconnectOnTimeout": true,
        "reconnectTimeout": 2000,
        "parallelUnitIdsAllowed": true,
        "showErrors": false,
        "showWarnings": true,
        "showLogs": true
    },
    {
        "id": "9d0d97191e966daa",
        "type": "influxdb",
        "hostname": "127.0.0.1",
        "port": "8086",
        "protocol": "http",
        "database": "database",
        "name": "InflusDB",
        "usetls": false,
        "tls": "",
        "influxdbVersion": "2.0",
        "url": "http://localhost:8086",
        "timeout": "10",
        "rejectUnauthorized": true
    },
    {
        "id": "365f28a092b798cf",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "f024d651beb8c867",
        "type": "ui_tab",
        "name": "Alarmas",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "8fcf31b05256c400",
        "type": "ui_tab",
        "name": "reciveCleaner",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "7ea6cfb5e131380a",
        "type": "ui_tab",
        "name": "AnalogSet",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "7fca2bd4d0a6004c",
        "type": "ui_tab",
        "name": "Tiket",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "760bb6adf93f32f8",
        "type": "ui_group",
        "name": "DisplayAlarms",
        "tab": "f024d651beb8c867",
        "order": 1,
        "disp": false,
        "width": "30",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2b6a27989e458e3b",
        "type": "ui_group",
        "name": "G1",
        "tab": "8fcf31b05256c400",
        "order": 1,
        "disp": true,
        "width": 30,
        "collapse": false,
        "className": ""
    },
    {
        "id": "e230319ddc57e5e6",
        "type": "ui_group",
        "name": "g1",
        "tab": "7ea6cfb5e131380a",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "42b15aafb8d1be1d",
        "type": "ui_group",
        "name": "G1",
        "tab": "7fca2bd4d0a6004c",
        "order": 1,
        "disp": true,
        "width": 30,
        "collapse": false,
        "className": ""
    },
    {
        "id": "8a9376f64511d022",
        "type": "sqlitedb",
        "db": "/data/db/tags_terminal_galan.db",
        "mode": "RWC"
    },
    {
        "id": "677eeae544510f07",
        "type": "ui_tab",
        "name": "Main",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f5490ef343d6cb98",
        "type": "ui_group",
        "name": "G1",
        "tab": "677eeae544510f07",
        "order": 1,
        "disp": false,
        "width": 30,
        "collapse": false,
        "className": ""
    },
    {
        "id": "5e1235646b51a204",
        "type": "ui_spacer",
        "z": "6910828fa524c0ad",
        "name": "spacer",
        "group": "760bb6adf93f32f8",
        "order": 2,
        "width": 11,
        "height": 1
    },
    {
        "id": "0a4661198b96304f",
        "type": "ui_spacer",
        "z": "6910828fa524c0ad",
        "name": "spacer",
        "group": "760bb6adf93f32f8",
        "order": 4,
        "width": 11,
        "height": 1
    },
    {
        "id": "a5843e127eb4f722",
        "type": "postgreSQLConfig",
        "name": "",
        "host": "127.0.0.1",
        "hostFieldType": "str",
        "port": "5432",
        "portFieldType": "num",
        "database": "gas_dispatch_db",
        "databaseFieldType": "str",
        "ssl": "false",
        "sslFieldType": "bool",
        "applicationName": "",
        "applicationNameType": "str",
        "max": "10",
        "maxFieldType": "num",
        "idle": "1000",
        "idleFieldType": "num",
        "connectionTimeout": "10000",
        "connectionTimeoutFieldType": "num",
        "user": "admin",
        "userFieldType": "str",
        "password": "posgresadmin",
        "passwordFieldType": "str"
    },
    {
        "id": "b1f3173df94ca611",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 1,
        "width": 2,
        "height": 1
    },
    {
        "id": "65b587efe53c969d",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 3,
        "width": 2,
        "height": 1
    },
    {
        "id": "01b75bf579301087",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 4,
        "width": 2,
        "height": 1
    },
    {
        "id": "ddc4ce6d0eeec43a",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 5,
        "width": 2,
        "height": 1
    },
    {
        "id": "259d56b3b8829bab",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 6,
        "width": 2,
        "height": 1
    },
    {
        "id": "e163e13dea4c14e2",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 7,
        "width": 2,
        "height": 1
    },
    {
        "id": "252c4be39f78bfa3",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "d7653166accf8fec",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 9,
        "width": 2,
        "height": 1
    },
    {
        "id": "a0cbca5d209ca690",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 10,
        "width": 2,
        "height": 1
    },
    {
        "id": "42f8e5260c8b99c2",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 11,
        "width": 2,
        "height": 1
    },
    {
        "id": "86f1cb355789c7c4",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 12,
        "width": 2,
        "height": 1
    },
    {
        "id": "c71ca6086f8436a0",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 13,
        "width": 2,
        "height": 1
    },
    {
        "id": "4b9d6e40b1c3f5c4",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 14,
        "width": 2,
        "height": 1
    },
    {
        "id": "0b28e914220f8d8c",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 15,
        "width": 2,
        "height": 1
    },
    {
        "id": "3e695405fe6336c5",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 16,
        "width": 2,
        "height": 1
    },
    {
        "id": "5cd21b671a68b260",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 17,
        "width": 2,
        "height": 1
    },
    {
        "id": "f91748ed34565da3",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 18,
        "width": 2,
        "height": 1
    },
    {
        "id": "71df12c5730be14c",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 19,
        "width": 2,
        "height": 1
    },
    {
        "id": "b9d807d25d6951ee",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 20,
        "width": 2,
        "height": 1
    },
    {
        "id": "fc7c878dddeeac1b",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 21,
        "width": 2,
        "height": 1
    },
    {
        "id": "95cebfcbc8c9e565",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 22,
        "width": 2,
        "height": 1
    },
    {
        "id": "6843a96ad842b6c5",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 23,
        "width": 2,
        "height": 1
    },
    {
        "id": "5959d89802295bf4",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 24,
        "width": 2,
        "height": 1
    },
    {
        "id": "6c9b116babad2566",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 25,
        "width": 2,
        "height": 1
    },
    {
        "id": "3e8bc55e0b878aea",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 26,
        "width": 2,
        "height": 1
    },
    {
        "id": "f11ff75876fd5c00",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 27,
        "width": 2,
        "height": 1
    },
    {
        "id": "592ed5cfbce3b2e7",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 28,
        "width": 2,
        "height": 1
    },
    {
        "id": "c62761683cf0075a",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 29,
        "width": 2,
        "height": 1
    },
    {
        "id": "33ef215b8a02ab97",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 30,
        "width": 2,
        "height": 1
    },
    {
        "id": "f224d8b8f87298e1",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 31,
        "width": 2,
        "height": 1
    },
    {
        "id": "92c8b87d7ce83f57",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 32,
        "width": 2,
        "height": 1
    },
    {
        "id": "eab49f318d7d513f",
        "type": "ui_spacer",
        "z": "619addbf2da107aa",
        "name": "spacer",
        "group": "42b15aafb8d1be1d",
        "order": 33,
        "width": 2,
        "height": 1
    },
    {
        "id": "c2bd2524a791d21d",
        "type": "modbus-client",
        "name": "ModbusSIM",
        "clienttype": "tcp",
        "bufferCommands": true,
        "stateLogEnabled": false,
        "queueLogEnabled": false,
        "failureLogEnabled": true,
        "tcpHost": "127.0.0.1",
        "tcpPort": 502,
        "tcpType": "DEFAULT",
        "serialPort": "/dev/ttyUSB",
        "serialType": "RTU-BUFFERD",
        "serialBaudrate": 9600,
        "serialDatabits": 8,
        "serialStopbits": 1,
        "serialParity": "none",
        "serialConnectionDelay": 100,
        "serialAsciiResponseStartDelimiter": "0x3A",
        "unit_id": 1,
        "commandDelay": 1,
        "clientTimeout": 1000,
        "reconnectOnTimeout": true,
        "reconnectTimeout": 2000,
        "parallelUnitIdsAllowed": true,
        "showErrors": false,
        "showWarnings": true,
        "showLogs": true
    },
    {
        "id": "ce148dfbc170b5ca",
        "type": "ui_spacer",
        "z": "8389501e8b369815",
        "name": "spacer",
        "group": "2b6a27989e458e3b",
        "order": 3,
        "width": 10,
        "height": 1
    },
    {
        "id": "36b2749da6354b40",
        "type": "ui_spacer",
        "z": "8389501e8b369815",
        "name": "spacer",
        "group": "f5490ef343d6cb98",
        "order": 4,
        "width": 16,
        "height": 1
    },
    {
        "id": "ebe657afe3543e1e",
        "type": "ui_spacer",
        "z": "8389501e8b369815",
        "name": "spacer",
        "group": "f5490ef343d6cb98",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "c0a9d20148fed75b",
        "type": "modbus-flex-connector",
        "z": "ee81cc611986e56f",
        "name": "Modbus",
        "maxReconnectsPerMinute": 4,
        "emptyQueue": false,
        "showStatusActivities": true,
        "showErrors": true,
        "server": "c11465eb77fd5a0c",
        "emptyMsgOnFail": true,
        "configMsgOnChange": true,
        "x": 340,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "f00c53b575e9053a",
        "type": "modbus-read",
        "z": "ee81cc611986e56f",
        "name": "ReadPLC",
        "topic": "",
        "showStatusActivities": false,
        "logIOActivities": false,
        "showErrors": false,
        "showWarnings": true,
        "unitid": "1",
        "dataType": "HoldingRegister",
        "adr": "100",
        "quantity": "10",
        "rate": "500",
        "rateUnit": "ms",
        "delayOnStart": false,
        "startDelayTime": "",
        "server": "c11465eb77fd5a0c",
        "useIOFile": false,
        "ioFile": "",
        "useIOForPayload": false,
        "emptyMsgOnFail": false,
        "x": 340,
        "y": 420,
        "wires": [
            [
                "ddbabad2b3db6a89"
            ],
            []
        ]
    },
    {
        "id": "ddbabad2b3db6a89",
        "type": "function",
        "z": "ee81cc611986e56f",
        "name": "Get_data",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "ce83e8e3ba259427",
        "type": "inject",
        "z": "ee81cc611986e56f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 350,
        "y": 220,
        "wires": [
            [
                "a892b35494408802"
            ]
        ]
    },
    {
        "id": "a892b35494408802",
        "type": "function",
        "z": "ee81cc611986e56f",
        "name": "Power UP",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// El código añadido aquí se ejecutará una vez\n// cuando el nodo es iniciado.\n\nglobal.set(\"PU\",1);\nglobal.set(\"IS_REPORT\",false);\n\n// let tag = {\n//     \"ID\": 0,\n//     \"TagName\": \"PIT_2001\",\n//     \"Descripcion\": \"Presion de Descarga\",\n//     \"und\": \"PSI\",\n//     \"PV\": 0.0,\n//     \"HH\": 95.0,\n//     \"H\": 90.0,\n//     \"L\": 15.0,\n//     \"LL\": 10,\n//     \"Max\": 560,\n//     \"Min\": 0,\n//     \"enableHH\": 1,\n//     \"enableH\": 1,\n//     \"enableL\": 1,\n//     \"enableLL\": 1,\n//     \"ALARM\": \"#00f800\",\n//     \"FAIL\": 0,\n// }\n// global.set(tag.TagName,tag);\n\n// tag = {\n//     \"ID\": 0,\n//     \"TagName\": \"TIT_2001\",\n//     \"Descripcion\": \"Teperatura de Descarga\",\n//     \"und\": \"°F\",\n//     \"PV\": 0.0,\n//     \"HH\": 95.0,\n//     \"H\": 90.0,\n//     \"L\": 15.0,\n//     \"LL\": 10,\n//     \"Max\": 560,\n//     \"Min\": 0,\n//     \"enableHH\": 1,\n//     \"enableH\": 1,\n//     \"enableL\": 1,\n//     \"enableLL\": 1,\n//     \"ALARM\": \"#00f800\",\n//     \"FAIL\": 0,\n// };\n// global.set(tag.TagName, tag);\n\n// tag = {\n//     \"ID\": 0,\n//     \"TagName\": \"FIT_2001\",\n//     \"Descripcion\": \"Flujo de gas\",\n//     \"und\": \"kg/m3\",\n//     \"PV\": 0.0,\n//     \"HH\": 95.0,\n//     \"H\": 90.0,\n//     \"L\": 15.0,\n//     \"LL\": 10,\n//     \"Max\": 560,\n//     \"Min\": 0,\n//     \"enableHH\": 1,\n//     \"enableH\": 1,\n//     \"enableL\": 1,\n//     \"enableLL\": 1,\n//     \"ALARM\": \"#00f800\",\n//     \"FAIL\": 0,\n// };\n// global.set(tag.TagName, tag);\n\n\n",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "edae4b4579709ee6",
        "type": "function",
        "z": "ee81cc611986e56f",
        "name": "function 61",
        "func": "msg.payload={\n    \"flowRate\" : 100 ,\n    \"densidadObservada\" : 0.805, \n    \"temperaturaObservada\" : 50.5\n}\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "5734cc982a2680df",
        "type": "inject",
        "z": "ee81cc611986e56f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 330,
        "y": 540,
        "wires": [
            [
                "edae4b4579709ee6"
            ]
        ]
    },
    {
        "id": "3e79d2e3b6c47521",
        "type": "debug",
        "z": "ee81cc611986e56f",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 160,
        "wires": []
    },
    {
        "id": "9357d44548474369",
        "type": "modbus-read",
        "z": "ee81cc611986e56f",
        "name": "",
        "topic": "",
        "showStatusActivities": false,
        "logIOActivities": false,
        "showErrors": false,
        "showWarnings": true,
        "unitid": "",
        "dataType": "HoldingRegister",
        "adr": "0",
        "quantity": "26",
        "rate": "2",
        "rateUnit": "s",
        "delayOnStart": false,
        "startDelayTime": "",
        "server": "c2bd2524a791d21d",
        "useIOFile": false,
        "ioFile": "",
        "useIOForPayload": false,
        "emptyMsgOnFail": false,
        "x": 310,
        "y": 660,
        "wires": [
            [
                "92e760591758053b"
            ],
            []
        ]
    },
    {
        "id": "3b3b2cff75facb63",
        "type": "debug",
        "z": "ee81cc611986e56f",
        "name": "debug 1",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 660,
        "y": 640,
        "wires": []
    },
    {
        "id": "92e760591758053b",
        "type": "function",
        "z": "ee81cc611986e56f",
        "name": "function 2",
        "func": "\n\n\n// Función para convertir dos registros de 16 bits a un Int32\nfunction registrosAInt32(lowWord, highWord) {\n    return (highWord << 16) | lowWord;\n}\n\n// Leer los datos de BUTANO\nvar butano = {\n    presion: msg.payload[0] / 10,\n    flujo: msg.payload[1] / 10,\n    temperatura: msg.payload[2] / 10,\n    nivel: msg.payload[3],\n    densidad: registrosAInt32(msg.payload[4], msg.payload[5]) / 100,\n    batch: registrosAInt32(msg.payload[6], msg.payload[7])\n};\n\n// Leer los datos de PROPANO\nvar propano = {\n    presion: msg.payload[10] / 10,\n    flujo: msg.payload[11] / 10,\n    temperatura: msg.payload[12] / 10,\n    nivel: msg.payload[13],\n    densidad: registrosAInt32(msg.payload[14], msg.payload[15]) / 100,\n    batch: registrosAInt32(msg.payload[16], msg.payload[17])\n};\n\n// Guardar en global context\nglobal.set(\"BUTANO\", butano);\nglobal.set(\"PROPANO\", propano);\n\n// Leer tiquete y estado\nglobal.set(\"TIKET_N\", msg.payload[24]);\nglobal.set(\"ESTADO_BATCH\", msg.payload[23]); // 0=Pausado, 1=Activo\n\n// Opcional: también puedes leer la fecha del PLC si la agregaste\n// var año = msg.payload[25];\n// var mes = msg.payload[27];\n// var dia = msg.payload[28];\n// var hora = msg.payload[29];\n// var minuto = msg.payload[30];\n// var segundo = msg.payload[31];\n\nlet tag=global.get(\"PIT_2001\");\ntag.PV=butano.presion;\n\ntag=global.get(\"TIT_2001\");\ntag.PV=butano.temperatura;\n\ntag=global.get(\"FIT_2001\");\ntag.PV=butano.flujo;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 640,
        "wires": [
            [
                "3b3b2cff75facb63"
            ]
        ]
    },
    {
        "id": "68c5cc74e68f4adf",
        "type": "template",
        "z": "6910828fa524c0ad",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{!-- <style>\n  .alarm-table { width: 100%; border-collapse: collapse; color: #e0e0e0; }\n  .alarm-table th { background-color: #4a4a4a; color: white; padding: 8px; text-align: left; }\n  .alarm-table td { padding: 8px; border-bottom: 1px solid #606060; }\n  .alarm-table tr:nth-child(even) { background-color: rgba(255, 255, 255, 0.05); }\n  .alarm-table tr:nth-child(odd) { background-color: rgba(0, 0, 0, 0.2); }\n  //.alarm-cell { font-weight: bold; border-radius: 4px; padding: 4px 8px; }\n  //.valor-cell { font-weight: bold; color: #4fc3f7; }\n</style> --}}\n\n<table class=\"alarm-table\"> \n    <tr> \n        <th>DATE</th>  \n        <th>TAG</th>  \n        <th>Valor</th>     \n        <th>Descripcion</th> \n        <th>Alerta</th> \n        <th>Unidad</th> \n    </tr> \n    {{#payload}} \n        <tr> \n            <td>{{DATE}}</td> \n            <td>{{TAG}}</td> \n            <td class=\"valor-cell\">{{Valor}}</td> \n            <td>{{Descripcion}}</td> \n            <td>\n                <span class=\"alarm-cell\" style=\"background-color: {{bgColor}}; color: {{textColor}};\">\n                    {{icon}} {{Alerta}}\n                </span>\n            </td> \n            <td>{{Unidad}}</td> \n        </tr> \n    {{/payload}} \n</table>",
        "output": "str",
        "x": 1200,
        "y": 400,
        "wires": [
            [
                "3d5d9c29d555f767"
            ]
        ]
    },
    {
        "id": "650558858afec541",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "function 40",
        "func": "const alarmas=[];\n\nglobal.set(\"ALARMAS\", alarmas);\nmsg.payload=alarmas;\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 400,
        "wires": [
            [
                "68c5cc74e68f4adf"
            ]
        ]
    },
    {
        "id": "74a9f6d128f66dce",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "Get PIT",
        "func": "let pv_sim=flow.get(\"PV_SIM\");\nlet butano=global.get(\"BUTANO\");\n\n\nlet tag=global.get(\"PIT_2001\");\nmsg.payload=tag;\n\n// pv_sim+=2.55;\n// if(pv_sim>100)pv_sim=0;\n// flow.set(\"PV_SIM\",pv_sim);\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// El código añadido aquí se ejecutará una vez\n// cuando el nodo es iniciado.\nflow.set(\"PV_SIM\",0);",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 440,
        "wires": [
            [
                "0b8b85192a91ddf4"
            ]
        ]
    },
    {
        "id": "0458dd2af263c9a8",
        "type": "inject",
        "z": "6910828fa524c0ad",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "[{\"pit_01\":0.1,\"pit_02\":0.23},{\"pit_01\":0.1,\"pit_02\":0.23},{\"pit_01\":0.1,\"pit_02\":0.23},{\"pit_01\":0.2,\"pit_02\":0.4},{\"pit_01\":0.4,\"pit_02\":0.45}]",
        "payloadType": "json",
        "x": 140,
        "y": 480,
        "wires": [
            [
                "74a9f6d128f66dce",
                "e18c9959712a0576",
                "4c668c7ececdd5e7"
            ]
        ]
    },
    {
        "id": "0b8b85192a91ddf4",
        "type": "alarm-scanner",
        "z": "6910828fa524c0ad",
        "name": "",
        "x": 500,
        "y": 480,
        "wires": [
            [
                "88da1e3464bf4a4d"
            ]
        ]
    },
    {
        "id": "88da1e3464bf4a4d",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "function 48",
        "func": "let alarmas = [];\nalarmas=global.get(\"ALARMAS\") || [];\n\nlet msg1={};\nlet tag=msg.payload;\nmsg1.payload=tag;\n\nif(msg.alarms.length>=1)\n{\n    alarmas.push(msg.alarms[0]);\n    if(alarmas.length>25)alarmas.pop();    \n    global.set(\"ALARMAS\",alarmas);\n}\n\nif(alarmas.length>=1)msg.payload=alarmas;\nelse msg.payload=\"NULL\";\n\nglobal.set(tag.TagName,tag);\n\n\nreturn [msg,msg1];",
        "outputs": 2,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 480,
        "wires": [
            [
                "fa2e643d23619183"
            ],
            [
                "446d913f27b17fc4"
            ]
        ]
    },
    {
        "id": "446d913f27b17fc4",
        "type": "debug",
        "z": "6910828fa524c0ad",
        "name": "",
        "active": false,
        "console": "false",
        "complete": "false",
        "x": 1210,
        "y": 500,
        "wires": []
    },
    {
        "id": "fa2e643d23619183",
        "type": "switch",
        "z": "6910828fa524c0ad",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "NULL",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 850,
        "y": 460,
        "wires": [
            [
                "0db00293fc5b18cb"
            ]
        ]
    },
    {
        "id": "0db00293fc5b18cb",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "function 49",
        "func": "// Asumimos que msg.payload contiene el array de objetos de alarma\nmsg.payload = msg.payload.map(alarm => {\n    let severity, icon;\n    \n    // Determinar la severidad y el icono basado en el texto de la Alerta\n    if (alarm.Alerta.includes('Muy Alta') || alarm.Alerta.includes('Muy Baja')) {\n        severity = 'high';\n        icon = '⚠️';\n    } else if (alarm.Alerta.includes('Alta') || alarm.Alerta.includes('Baja')) {\n        severity = 'medium';\n        icon = '⚠';\n    } else {\n        severity = 'low';\n        icon = 'ℹ️';\n    }\n    \n    // Determinar el color basado en AlarmColor\n    let textColor;\n    switch (alarm.AlarmColor) {\n        case '#8E0000':\n            textColor = '#ff6b6b'; // Rojo más brillante para tema oscuro\n            break;\n        case '#FFFF00':\n            textColor = '#feca57'; // Amarillo más oscuro para mejor contraste\n            break;\n        default:\n            textColor = '#48dbfb'; // Azul claro por defecto\n    }\n    \n    // Retornar el objeto de alarma con las nuevas propiedades\n    return {\n        ...alarm,\n        severity,\n        icon,\n        textColor\n    };\n});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 460,
        "wires": [
            [
                "68c5cc74e68f4adf",
                "446d913f27b17fc4"
            ]
        ]
    },
    {
        "id": "a4a46de3e2302c3e",
        "type": "ui_button",
        "z": "6910828fa524c0ad",
        "name": "",
        "group": "760bb6adf93f32f8",
        "order": 3,
        "width": 5,
        "height": 1,
        "passthru": false,
        "label": "Borrar ",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 400,
        "wires": [
            [
                "650558858afec541"
            ]
        ]
    },
    {
        "id": "3d5d9c29d555f767",
        "type": "ui_template",
        "z": "6910828fa524c0ad",
        "group": "760bb6adf93f32f8",
        "name": "",
        "order": 1,
        "width": 30,
        "height": 12,
        "format": "<style>\n    table {\n    border-collapse: collapse;\n    width: 100%;\n    }\n    \n    th, td {\n    text-align: left;\n    padding: 8px;\n    }\n    \n    th {\n    background-color: #007bff;\n    color: white;\n    }\n    \n    .alarm-table { width: 100%; border-collapse: collapse; color: #e0e0e0; }\n    .alarm-table th { background-color: #4a4a4a; color: white; padding: 8px; text-align: left; }\n    .alarm-table td { padding: 8px; border-bottom: 1px solid #606060; }\n    .alarm-table tr:nth-child(even) { background-color: rgba(255, 255, 255, 0.05); }\n    .alarm-table tr:nth-child(odd) { background-color: rgba(0, 0, 0, 0.2); }\n    .alarm-cell { font-weight: bold; border-radius: 4px; padding: 4px 8px; }\n    .valor-cell { font-weight: bold; color: #4fc3f7; }\n</style>\n\n<div ng-bind-html=\"msg.payload\"></div>\n",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1360,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "e19dfa611b5cde75",
        "type": "ui_button",
        "z": "6910828fa524c0ad",
        "name": "",
        "group": "760bb6adf93f32f8",
        "order": 5,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Cerrar",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"tab\":\"Main\"}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 340,
        "wires": [
            [
                "1eeb858bc2bdf568"
            ]
        ]
    },
    {
        "id": "1eeb858bc2bdf568",
        "type": "ui_ui_control",
        "z": "6910828fa524c0ad",
        "name": "",
        "events": "all",
        "x": 320,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "e18c9959712a0576",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "Get TIT",
        "func": "let pv_sim=flow.get(\"PV_SIM\");\nlet butano= global.get(\"BUTANO\");\n\nlet tag=global.get(\"TIT_2001\");\n\nmsg.payload=tag;\n\n// pv_sim+=2.55;\n// if(pv_sim>100)pv_sim=0;\n// flow.set(\"PV_SIM\",pv_sim);\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// El código añadido aquí se ejecutará una vez\n// cuando el nodo es iniciado.\nflow.set(\"PV_SIM\",0);",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 480,
        "wires": [
            [
                "0b8b85192a91ddf4"
            ]
        ]
    },
    {
        "id": "4c668c7ececdd5e7",
        "type": "function",
        "z": "6910828fa524c0ad",
        "name": "Get FIT",
        "func": "let pv_sim=flow.get(\"PV_SIM\");\nlet butano= global.get(\"BUTANO\");\n\nlet tag=global.get(\"FIT_2001\");\n\nmsg.payload=tag;\n\n// pv_sim+=2.55;\n// if(pv_sim>100)pv_sim=0;\n// flow.set(\"PV_SIM\",pv_sim);\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// El código añadido aquí se ejecutará una vez\n// cuando el nodo es iniciado.\nflow.set(\"PV_SIM\",0);",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 520,
        "wires": [
            [
                "0b8b85192a91ddf4"
            ]
        ]
    },
    {
        "id": "5201111b146857e8",
        "type": "ctl-calculator",
        "z": "2810139c92bd41d8",
        "name": "",
        "minDensity": "0.35",
        "maxDensity": "0.6880",
        "x": 540,
        "y": 320,
        "wires": [
            [
                "6277713b98f280b8"
            ]
        ]
    },
    {
        "id": "3e6ef4224e957778",
        "type": "function",
        "z": "2810139c92bd41d8",
        "name": "function 65",
        "func": "\n\nmsg.payload={\n    \"mA\": 6.37,\n    \"temperature\":87.4200\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 330,
        "y": 320,
        "wires": [
            [
                "5201111b146857e8"
            ]
        ]
    },
    {
        "id": "6277713b98f280b8",
        "type": "debug",
        "z": "2810139c92bd41d8",
        "name": "debug 7",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 770,
        "y": 320,
        "wires": []
    },
    {
        "id": "b1817f3939b3dfa8",
        "type": "inject",
        "z": "2810139c92bd41d8",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 320,
        "wires": [
            [
                "3e6ef4224e957778"
            ]
        ]
    },
    {
        "id": "e643deca182ab68b",
        "type": "inject",
        "z": "8389501e8b369815",
        "name": "1s",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 200,
        "wires": [
            [
                "3a0f9034167d1e6d"
            ]
        ]
    },
    {
        "id": "3a0f9034167d1e6d",
        "type": "function",
        "z": "8389501e8b369815",
        "name": "UpdateDisplay",
        "func": "\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 200,
        "wires": [
            [
                "e0e404b8557d360a"
            ]
        ]
    },
    {
        "id": "50ba8e0e315ffe7f",
        "type": "switch",
        "z": "8389501e8b369815",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 790,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "e0e404b8557d360a",
        "type": "ui_svg_graphics",
        "z": "8389501e8b369815",
        "group": "2b6a27989e458e3b",
        "order": 1,
        "width": 30,
        "height": 14,
        "svgString": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!-- Created with Inkscape (http://www.inkscape.org/) -->\n\n<svg version=\"1.1\" id=\"svg1\" xml:space=\"preserve\" width=\"1101.8414\" height=\"539.56659\"\n    xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n    xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns=\"http://www.w3.org/2000/svg\" xmlns:svg=\"http://www.w3.org/2000/svg\">\n    <defs id=\"defs1\">\n        <marker style=\"overflow:visible\" id=\"Sketch\" refX=\"0\" refY=\"0\" orient=\"auto-start-reverse\"\n            inkscape:stockid=\"Sketched arrow\" markerWidth=\"1\" markerHeight=\"1\" viewBox=\"0 0 1 1\" inkscape:isstock=\"true\"\n            inkscape:collect=\"always\" preserveAspectRatio=\"xMidYMid\">\n            <path style=\"fill:none;stroke:context-stroke;stroke-width:0.4;stroke-linecap:round\"\n                d=\"m -4.5421538,-3.2452189 3.83900644,2.60235235 0.56348102,0.59255887 L -2.4921466,1.1808717 -4.4106004,2.139946 -4.5795251,2.8245356 -4.703996,3.0734773 -4.3128019,2.6822832 -3.9749524,2.3088707 0.66603196,-0.12720162 0.02589622,-0.32279868 -1.7613224,-0.60366199 -3.580874,-2.0472634 -4.3186004,-2.392437 l -1.2937699,-0.2549423 2.1825172,0.042166 0.6996091,1.0554873 1.4406512,0.1145833 1.20879971,0.91674665 1.53333299,0.47138389 -1.85995289,1.23785256 -2.03832621,0.9224332 -1.5469949,0.9779853\"\n                sodipodi:nodetypes=\"ccc\" id=\"path9\" />\n        </marker>\n        <marker style=\"overflow:visible\" id=\"ArrowWide\" refX=\"0\" refY=\"0\" orient=\"auto-start-reverse\"\n            inkscape:stockid=\"Wide arrow\" markerWidth=\"1\" markerHeight=\"1\" viewBox=\"0 0 1 1\" inkscape:isstock=\"true\"\n            inkscape:collect=\"always\" preserveAspectRatio=\"xMidYMid\">\n            <path style=\"fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt\" d=\"M 3,-3 0,0 3,3\"\n                transform=\"rotate(180,0.125,0)\" sodipodi:nodetypes=\"ccc\" id=\"path1\" />\n        </marker>\n        <rect x=\"291.86917\" y=\"216.00426\" width=\"139.78812\" height=\"152.43227\" id=\"rect1\" />\n        <linearGradient class=\"linear\" id=\"SVGID_1_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"23.924\" y1=\"95.863899\"\n            x2=\"23.924\" y2=\"58.4035\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop5-7\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop6-5\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_2_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"75.825996\" y1=\"95.863899\"\n            x2=\"75.825996\" y2=\"58.4035\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop7-9\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop8-2\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_3_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"42.25\" y1=\"77.133698\"\n            x2=\"54.75\" y2=\"77.133698\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop9-2\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop10-8\" />\n        </linearGradient>\n        <linearGradient inkscape:collect=\"always\" xlink:href=\"#linearGradient22\" id=\"linearGradient24\"\n            gradientUnits=\"userSpaceOnUse\" gradientTransform=\"matrix(2.5279862,0,0,0.08719459,-529.00266,100.83954)\"\n            x1=\"258.21692\" y1=\"72.793594\" x2=\"258.21692\" y2=\"138.89528\" />\n        <linearGradient id=\"linearGradient22\" inkscape:collect=\"always\">\n            <stop style=\"stop-color:#e65309;stop-opacity:0.99052501;\" offset=\"0\" id=\"stop22\" />\n            <stop style=\"stop-color:#f0f3f5;stop-opacity:0.98039216;\" offset=\"0.5\" id=\"stop24\" />\n            <stop style=\"stop-color:#e17313;stop-opacity:0.96796471;\" offset=\"1\" id=\"stop23\" />\n        </linearGradient>\n    </defs>\n    <sodipodi:namedview id=\"namedview1\" pagecolor=\"#ffffff\" bordercolor=\"#000000\" borderopacity=\"0.25\"\n        inkscape:showpageshadow=\"2\" inkscape:pageopacity=\"0.0\" inkscape:pagecheckerboard=\"0\"\n        inkscape:deskcolor=\"#d1d1d1\" />\n    <inkscape:clipboard min=\"4.4057047e-10,-1.1221157e-07\" max=\"1101.8415,539.5666\" geom-min=\"0.46987275,0.46987264\"\n        geom-max=\"1101.3716,539.09673\" />\n    <g id=\"g1\" transform=\"matrix(3.7795276,0,0,3.7795276,0.56692906,-23.275111)\">\n        <rect style=\"fill:url(#linearGradient24);stroke:#b9b9b9;stroke-width:0.119721;stroke-opacity:1\" id=\"rect24\"\n            width=\"166.45949\" height=\"6.8802786\" x=\"40.536358\" y=\"106.62844\" />\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.126334;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect838\" width=\"40.936558\" height=\"27.49966\" x=\"108.74387\" y=\"69.247345\" ry=\"1.1820195\" />\n        <rect x=\"118.07779\" y=\"87.218422\"\n            style=\"fill:#20a040;stroke:#000000;stroke-width:0.0988302;stroke-miterlimit:4;stroke-dasharray:none\"\n            id=\"PIT_2001_BACK\" width=\"29.901171\" height=\"8.9342775\" ry=\"1.5642198\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"118.91536\" y=\"74.748466\"\n            id=\"e3_texte\" transform=\"scale(0.99223329,1.0078275)\">PIT_2002</text>\n        <rect x=\"119.32251\" y=\"88.681038\" style=\"fill:#000000;stroke:#000000;stroke-width:0.351923px\" id=\"PB_PIT_2001\"\n            width=\"27.1689\" height=\"6.0029826\" ry=\"1.774224\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"121.89095\" y=\"92.921585\"\n            id=\"PIT_2002_PV\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <g id=\"g17\" transform=\"matrix(1.5511032,0,0,1.6541503,-67.979304,-70.055251)\">\n            <path id=\"path45\" style=\"fill:#0000ff;fill-opacity:1;stroke:#303130;stroke-width:0.201537;stroke-opacity:1\"\n                d=\"m 93.363628,96.83969 a 4.1227484,3.9335248 0 0 0 -4.12256,3.9335 4.1227484,3.9335248 0 0 0 2.35587,3.54978 v 2.47693 h 3.21985 v -2.35634 a 4.1227484,3.9335248 0 0 0 2.66985,-3.67037 4.1227484,3.9335248 0 0 0 -4.12301,-3.9335 z\" />\n            <ellipse style=\"fill:#4e802b;fill-opacity:1;stroke:#d6d6d6;stroke-width:0.3156;stroke-opacity:1\" id=\"path46\"\n                cx=\"93.308426\" cy=\"100.81948\" rx=\"2.8750091\" ry=\"2.779753\" />\n        </g>\n        <rect style=\"fill:#1c1c1d;fill-opacity:1;stroke:#303130;stroke-width:0.214313;stroke-opacity:1\" id=\"rect46\"\n            width=\"1.2072288\" height=\"1.3368448\" x=\"130.67928\" y=\"105.40663\" />\n        <path id=\"path47\" style=\"fill:#0000ff;fill-opacity:1;stroke:#303130;stroke-width:0.201537;stroke-opacity:1\"\n            d=\"m 133.33475,96.971823 a 4.1227484,3.9335248 0 0 0 -4.12256,3.933497 4.1227484,3.9335248 0 0 0 2.35587,3.54978 v 2.47693 h 3.21985 v -2.35634 a 4.1227484,3.9335248 0 0 0 2.66985,-3.67037 4.1227484,3.9335248 0 0 0 -4.12301,-3.933497 z\" />\n        <ellipse style=\"fill:#4e802b;fill-opacity:1;stroke:#d6d6d6;stroke-width:0.3156;stroke-opacity:1\" id=\"ellipse47\"\n            cx=\"133.27956\" cy=\"100.95161\" rx=\"2.8750091\" ry=\"2.779753\" />\n        <g id=\"g2\" transform=\"translate(28.250313,11.894869)\">\n            <g id=\"g55\" transform=\"matrix(0.86692568,0,0,1.2298261,10.534371,-93.543554)\">\n                <g id=\"shape-8\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\"\n                    style=\"fill:#fb5700;fill-opacity:1\">\n                    <path fill=\"#e34300\"\n                        d=\"m 94.488,54.267 v 9.427 H 80.995 C 76.955,58.43 70.604,55.033 63.456,55.033 h -4.672 v -4.03 H 66.19 V 38.002 H 84.306 V 36.5 H 86.5 V 33 h -2.194 v -1.877 h 1.416 c 1.833,0 3.334,-1.5 3.334,-3.334 V 10.381 c 0,-1.833 -1.5,-3.333 -3.334,-3.333 H 84.306 V 5.25 H 86.5 V 1.75 H 84.306 V 0.169 h -69 V 1.75 H 13 v 3.5 h 2.306 V 7.048 H 13.89 c -1.833,0 -3.334,1.5 -3.334,3.333 V 27.79 c 0,1.833 1.5,3.334 3.334,3.334 h 1.416 V 33 H 13 v 3.5 h 2.306 v 1.502 h 18.116 v 13.002 h 7.406 v 4.03 h -4.672 c -7.148,0 -13.5,3.397 -17.54,8.661 H 5.512 V 54.268 H 0 V 63.695 65.967 88.3 90.572 100 h 5.512 v -9.427 h 13.104 c 4.04,5.264 10.391,8.661 17.54,8.661 h 27.3 c 7.148,0 13.5,-3.397 17.54,-8.661 H 94.488 V 100 H 100 V 90.573 88.3 65.967 63.695 54.268 H 94.488 Z M 63.69,48.265 h -8.573 v -6.677 h 2.333 v -3.585 h 6.239 V 48.265 Z M 35.922,38.002 h 6.239 v 3.585 h 2.333 v 6.677 h -8.572 z\"\n                        id=\"path1-7\" style=\"fill:#fb5700;fill-opacity:1\" />\n                </g>\n                <g id=\"light-9\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\">\n                    <path fill=\"#ff5600\"\n                        d=\"m 51,58.3 c -0.428,0 -2.072,0 -2.5,0 -3.452,0 -6.25,8.432 -6.25,18.833 0,10.401 2.798,18.833 6.25,18.833 0.428,0 2.072,0 2.5,0 3.452,0 6.25,-8.432 6.25,-18.833 C 57.25,66.732 54.452,58.3 51,58.3 Z\"\n                        id=\"path2-2\" />\n                    <polygon fill=\"#ff5600\"\n                        points=\"66.19,38.002 63.69,38.002 63.69,48.265 35.922,48.265 35.922,38.002 33.422,38.002 33.422,51.004 66.19,51.004 \"\n                        id=\"polygon2\" />\n                </g>\n                <g id=\"dark-0\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\"\n                    style=\"fill:#3700cd;fill-opacity:1\">\n                    <rect fill=\"#8a3400\" x=\"13\" y=\"33\" width=\"2.306\" height=\"3.5\" id=\"rect2\"\n                        style=\"fill:#3700cd;fill-opacity:1\" />\n                    <rect fill=\"#8a3400\" x=\"84.306\" y=\"33\" width=\"2.194\" height=\"3.5\" id=\"rect3\"\n                        style=\"fill:#3700cd;fill-opacity:1\" />\n                    <path fill=\"#8a3400\"\n                        d=\"M 15.306,7.048 H 13.89 c -1.833,0 -3.334,1.5 -3.334,3.333 V 27.79 c 0,1.833 1.5,3.334 3.334,3.334 h 1.416 z\"\n                        id=\"path3-2\" style=\"fill:#3700cd;fill-opacity:1\" />\n                    <path fill=\"#8a3400\"\n                        d=\"m 85.722,7.048 h -1.416 v 24.076 h 1.416 c 1.833,0 3.334,-1.5 3.334,-3.334 V 10.381 c 0,-1.833 -1.501,-3.333 -3.334,-3.333 z\"\n                        id=\"path4\" style=\"fill:#3700cd;fill-opacity:1\" />\n                    <rect x=\"13\" y=\"1.75\" fill=\"#8a3400\" width=\"2.306\" height=\"3.5\" id=\"rect4\"\n                        style=\"fill:#3700cd;fill-opacity:1\" />\n                    <rect x=\"84.306\" y=\"1.75\" fill=\"#8a3400\" width=\"2.194\" height=\"3.5\" id=\"rect5\"\n                        style=\"fill:#3700cd;fill-opacity:1\" />\n                </g>\n                <g id=\"linear-3\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\">\n                    <linearGradient class=\"linear\" id=\"linearGradient2\" gradientUnits=\"userSpaceOnUse\" x1=\"23.924\"\n                        y1=\"95.863899\" x2=\"23.924\" y2=\"58.4035\">\n\n\n                        <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop1\" />\n                        <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop2\" />\n                    </linearGradient>\n                    <path class=\"linear\" fill=\"url(#SVGID_1_valve)\"\n                        d=\"m 42.25,77.134 c 0,-9.738 2.453,-17.748 5.598,-18.73 -5.426,0.547 -10.164,3.401 -13.239,7.564 H 0 V 88.3 h 34.609 c 3.075,4.162 7.813,7.016 13.239,7.564 -3.145,-0.983 -5.598,-8.992 -5.598,-18.73 z\"\n                        id=\"path6\" style=\"fill:url(#SVGID_1_valve)\" />\n                    <linearGradient class=\"linear\" id=\"linearGradient4\" gradientUnits=\"userSpaceOnUse\" x1=\"75.825996\"\n                        y1=\"95.863899\" x2=\"75.825996\" y2=\"58.4035\">\n\n\n                        <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop3\" />\n                        <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop4\" />\n                    </linearGradient>\n                    <path class=\"linear\" fill=\"url(#SVGID_2_valve)\"\n                        d=\"m 64.891,65.967 c -3.075,-4.162 -7.813,-7.016 -13.239,-7.564 3.145,0.983 5.598,8.992 5.598,18.73 0,9.738 -2.453,17.748 -5.598,18.73 5.426,-0.547 10.164,-3.401 13.239,-7.564 H 100 V 65.967 Z\"\n                        id=\"path8\" style=\"fill:url(#SVGID_2_valve)\" />\n                    <linearGradient class=\"linear\" id=\"linearGradient6\" gradientUnits=\"userSpaceOnUse\" x1=\"42.25\"\n                        y1=\"77.133698\" x2=\"54.75\" y2=\"77.133698\">\n\n\n                        <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop5\" />\n                        <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop6\" />\n                    </linearGradient>\n                    <ellipse class=\"linear\" fill=\"url(#SVGID_3_valve)\" cx=\"48.5\" cy=\"77.134003\" rx=\"6.25\" ry=\"18.833\"\n                        id=\"ellipse10\" style=\"fill:url(#SVGID_3_valve)\" />\n                </g>\n            </g>\n            <rect style=\"fill:#1c1c1d;fill-opacity:1;stroke:#303130;stroke-width:0.214313;stroke-opacity:1\" id=\"rect47\"\n                width=\"1.2072288\" height=\"1.3368448\" x=\"140.23166\" y=\"93.183914\" />\n        </g>\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.369405;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect49\" width=\"38.556229\" height=\"6.3695898\" x=\"110.09406\" y=\"70.75573\" ry=\"0.81231481\"\n            rx=\"0.69855058\" /><text xml:space=\"preserve\" transform=\"scale(0.26458333)\" id=\"text1\"\n            style=\"font-weight:bold;font-size:29.9359px;font-family:C059;-inkscape-font-specification:'C059, Bold';text-align:start;writing-mode:lr-tb;direction:ltr;white-space:pre;shape-inside:url(#rect1);display:inline;fill:#9d3600;stroke:#050505;stroke-width:1.13386\" />\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.384197;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect25-6\" width=\"60.625988\" height=\"36.086578\" x=\"42.094933\" y=\"50.258457\" ry=\"1.5511115\" />\n        <rect x=\"70.30748\" y=\"59.321159\"\n            style=\"fill:#20a040;stroke:#000000;stroke-width:0.0993539;stroke-miterlimit:4;stroke-dasharray:none\"\n            id=\"FIT_2001_FLOW_BACK\" width=\"30.220694\" height=\"8.933754\" ry=\"1.5641282\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"60.579071\" y=\"55.61478\"\n            id=\"text27-2\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">UIT_2002</text>\n        <rect x=\"71.39444\" y=\"60.461243\" style=\"fill:#000000;stroke:#000000;stroke-width:0.346362px\" id=\"PB_FIT_2001\"\n            width=\"28.052216\" height=\"6.5550799\" ry=\"1.6644852\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"73.301674\" y=\"65.240677\"\n            id=\"UIT_2002_SPEED\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect x=\"71.475288\" y=\"68.87603\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334892px\" id=\"rect29\"\n            width=\"27.851984\" height=\"6.1721406\" ry=\"1.5672482\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"73.844437\" y=\"73.07074\"\n            id=\"UIT_2001_TEMPERATURE\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect x=\"71.106773\" y=\"75.634094\" style=\"fill:#000000;stroke:#000000;stroke-width:0.336598px\" id=\"rect30\"\n            width=\"28.144466\" height=\"6.170434\" ry=\"1.5668147\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"73.634903\" y=\"79.445457\"\n            id=\"UIT_2001_PRESSURE\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"45.466679\" y=\"64.726151\"\n            id=\"text32\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Velocidad</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"45.838196\" y=\"73.009865\"\n            id=\"text33\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Densidad</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"52.803909\" y=\"80.038795\"\n            id=\"text34\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Bache</text>\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.204983;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect50\" width=\"57.050995\" height=\"6.2980514\" x=\"44.072979\" y=\"51.318455\" ry=\"0.80319154\"\n            rx=\"1.0336334\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.205698;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect51\" width=\"57.508957\" height=\"25.630621\" x=\"43.658142\" y=\"58.3102\" ry=\"1.278119\" rx=\"1.0419307\" />\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.302038;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect6\" width=\"40.17091\" height=\"33.659664\" x=\"151.90857\" y=\"36.092224\" ry=\"1.4467952\" />\n        <rect x=\"162.74426\" y=\"61.720524\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334892px\" id=\"rect7\"\n            width=\"27.851984\" height=\"6.1721406\" ry=\"1.5672482\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"165.82776\" y=\"65.97081\"\n            id=\"SIC_2002_CV\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"154.86693\" y=\"65.725517\"\n            id=\"text8\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Cv:</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"163.26767\" y=\"42.216702\"\n            id=\"text9\" transform=\"scale(0.99223329,1.0078275)\">SIC_2002</text>\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.35537;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect9\" width=\"35.603619\" height=\"6.383625\" x=\"154.37488\" y=\"37.830887\" ry=\"0.81410474\"\n            rx=\"0.64505607\" />\n        <rect x=\"162.74426\" y=\"53.253849\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334892px\" id=\"rect10\"\n            width=\"27.851984\" height=\"6.1721406\" ry=\"1.5672482\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"165.82776\" y=\"57.569923\"\n            id=\"SIC_2002_SP\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"154.86693\" y=\"57.324635\"\n            id=\"text11\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Sp:</text>\n        <rect x=\"162.74426\" y=\"45.845509\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334892px\" id=\"rect11\"\n            width=\"27.851984\" height=\"6.1721406\" ry=\"1.5672482\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"165.82776\" y=\"50.219151\"\n            id=\"SIC_2002_PV\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"154.86693\" y=\"49.973862\"\n            id=\"text13\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Pv:</text>\n        <path\n            style=\"fill:#9d3600;stroke:#b6b3b6;stroke-width:0.3;stroke-dasharray:1.2, 0.3;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#ArrowWide)\"\n            d=\"M 172.47559,70.254065 V 86.609512\" id=\"path13\" />\n        <path\n            style=\"fill:none;stroke:#d6dada;stroke-width:0.289574;stroke-dasharray:0.868721, 0.289574;stroke-dashoffset:0;stroke-opacity:1;marker-end:url(#Sketch)\"\n            d=\"m 102.60759,63.949539 h 14.17362 l -0.3457,-14.523204 34.91551,-0.744781\" id=\"path14\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"110.52087\" y=\"83.068748\"\n            id=\"text15\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Sp:</text>\n        <rect x=\"119.71677\" y=\"78.955887\" style=\"fill:#000000;stroke:#000000;stroke-width:0.351923px\" id=\"rect15\"\n            width=\"27.1689\" height=\"6.0029826\" ry=\"1.774224\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"122.2883\" y=\"83.271965\"\n            id=\"PIT_2002_SP\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"110.38842\" y=\"91.935966\"\n            id=\"text17\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Pv:</text><text\n            style=\"font-size:3.24893px;font-family:Arial;fill:#ffff00;stroke-width:0.162446\" x=\"73.654671\" y=\"96.979317\"\n            id=\"text18\" transform=\"scale(0.99246797,1.0075892)\" inkscape:label=\"LABEL\">8888</text><text\n            style=\"font-size:2.41441px;font-family:Arial;fill:#ffff00;stroke-width:0.12072\" x=\"170.86803\" y=\"78.364929\"\n            id=\"text19\" transform=\"scale(0.76834913,1.3014917)\" inkscape:label=\"LABEL\">8888</text>\n        <rect\n            style=\"fill:none;stroke:#050505;stroke-width:0.248641;stroke-dasharray:0.994566, 0.248641;stroke-dashoffset:0;stroke-opacity:1\"\n            id=\"rect19\" width=\"291.28024\" height=\"142.51169\" x=\"-0.02567948\" y=\"6.282527\" ry=\"0\" />\n    </g>\n</svg>",
        "clickableShapes": [],
        "javascriptHandlers": [],
        "smilAnimations": [],
        "bindings": [],
        "showCoordinates": false,
        "autoFormatAfterEdit": false,
        "showBrowserErrors": false,
        "showBrowserEvents": false,
        "enableJsDebugging": false,
        "sendMsgWhenLoaded": false,
        "noClickWhenDblClick": false,
        "outputField": "payload",
        "editorUrl": "//drawsvg.org/drawsvg.html",
        "directory": "",
        "panning": "disabled",
        "zooming": "disabled",
        "panOnlyWhenZoomed": false,
        "doubleClickZoomEnabled": false,
        "mouseWheelZoomEnabled": false,
        "dblClickZoomPercentage": 150,
        "cssString": "div.ui-svg svg{\n    color: var(--nr-dashboard-widgetColor);\n    fill: currentColor !important;\n}\ndiv.ui-svg path {\n    fill: inherit;\n}",
        "name": "",
        "x": 560,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "ba583c5f48df3905",
        "type": "function",
        "z": "a9cd65b1c67ffc15",
        "name": "function 50",
        "func": "\n\nlet tagName = global.get(\"SetingAnalog\");\nlet tag = global.get(tagName);\n\ntag.HH=msg.payload.SetHH;\ntag.H=msg.payload.SetH;\ntag.L = msg.payload.SetL;\ntag.LL = msg.payload.SetLL;\ntag.Min = msg.payload.SetMin;\ntag.Max = msg.payload.SetMax;\ntag.enableHH = msg.payload.EnableHH;\ntag.enableH = msg.payload.EnableH;\ntag.enableL = msg.payload.EnableL;\ntag.enableLL = msg.payload.EnableLL;\n\n\n\nglobal.set(\"EditTag\", false);\n\nmsg.payload = { \"tab\": global.get(\"returnTab\") || \"main\"}\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 850,
        "y": 260,
        "wires": [
            [
                "743b223254bc5cb1"
            ]
        ]
    },
    {
        "id": "6306d7ae2cbda46e",
        "type": "function",
        "z": "a9cd65b1c67ffc15",
        "name": "function 51",
        "func": "let tagName = global.get(\"SetingAnalog\");\nlet tag=global.get(tagName);\nlet ehh,eh,el,ell;\n\nif (tag.enableHH==1)  ehh= true;\nelse ehh = false;\n\nif (tag.enableH==1) eh= true;\nelse eh = false;\n\nif (tag.enableL==1) el = true;\nelse el = false;\n\nif (tag.enableLL==1) ell = true;\nelse ell = false;\n\n\n\n    msg.payload = {\n        \"TagName\": tag.TagName,\n        \"SetHH\": tag.HH,\n        \"SetH\": tag.H,\n        \"SetL\": tag.L,\n        \"SetLL\": tag.LL,\n        \"SetMin\": tag.Min,\n        \"SetMax\": tag.Max,\n        \"EnableHH\": ehh,\n        \"EnableH\": eh,\n        \"EnableL\": el,\n        \"EnableLL\": ell,\n    }\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 220,
        "wires": [
            [
                "bcb0bbe84fde79b0"
            ]
        ]
    },
    {
        "id": "f65750fa740d440e",
        "type": "inject",
        "z": "a9cd65b1c67ffc15",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "start",
        "payloadType": "str",
        "x": 90,
        "y": 280,
        "wires": [
            [
                "cb7c30ecc5d33f02"
            ]
        ]
    },
    {
        "id": "cb7c30ecc5d33f02",
        "type": "switch",
        "z": "a9cd65b1c67ffc15",
        "name": "",
        "property": "EditTag",
        "propertyType": "global",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 250,
        "y": 280,
        "wires": [
            [],
            [
                "6306d7ae2cbda46e"
            ]
        ]
    },
    {
        "id": "27ece5b8978544b2",
        "type": "function",
        "z": "a9cd65b1c67ffc15",
        "name": "Make_query",
        "func": "let tagName = global.get(\"SetingAnalog\");\nlet tag = global.get(tagName);\n\ntag.HH = msg.payload.SetHH;\ntag.H = msg.payload.SetH;\ntag.L = msg.payload.SetL;\ntag.LL = msg.payload.SetLL;\ntag.Min = msg.payload.SetMin;\ntag.Max = msg.payload.SetMax;\n\nif (msg.payload.EnableHH==true)tag.enableHH = 1;\nelse tag.enableHH = 0;\n\nif (msg.payload.EnableH == true) tag.enableH = 1;\nelse tag.enableH = 0;\n\nif (msg.payload.EnableL == true) tag.enableL = 1;\nelse tag.enableL = 0;\n\nif (msg.payload.EnableLL == true) tag.enableLL = 1;\nelse tag.enableLL = 0;\n\n\nmsg.topic = `UPDATE tblTags SET HH=$sethh,H=$seth, L=$setl, LL=$setll, Max=$max, Min=$min,enableHH=$ehh, enableH=$eh, enableL=$el, enableLL=$elll WHERE TagName=$tag `;\nmsg.payload = [tag.HH, tag.H, tag.L, tag.LL, tag.Max, tag.Min,tag.enableHH, tag.enableH, tag.enableL, tag.enableLL, tag.TagName];\nreturn msg;\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 870,
        "y": 180,
        "wires": [
            [
                "c9eae6cebc129e92"
            ]
        ]
    },
    {
        "id": "3ccb4c02865ecec5",
        "type": "ui_button",
        "z": "a9cd65b1c67ffc15",
        "name": "",
        "group": "e230319ddc57e5e6",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 80,
        "y": 220,
        "wires": [
            [
                "6306d7ae2cbda46e"
            ]
        ]
    },
    {
        "id": "bcb0bbe84fde79b0",
        "type": "ui_form",
        "z": "a9cd65b1c67ffc15",
        "name": "FormAnalogSet",
        "label": "{{payload.TagName}}",
        "group": "e230319ddc57e5e6",
        "order": 4,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Set HH",
                "value": "SetHH",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Enable HH",
                "value": "EnableHH",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Set H",
                "value": "SetH",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "EnableH",
                "value": "EnableH",
                "type": "checkbox",
                "required": true,
                "rows": null
            },
            {
                "label": "Set L",
                "value": "SetL",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Enable L",
                "value": "EnableL",
                "type": "checkbox",
                "required": false,
                "rows": null
            },
            {
                "label": "Set LL",
                "value": "SetLL",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Enable LL",
                "value": "EnableLL",
                "type": "checkbox",
                "required": false,
                "rows": null
            },
            {
                "label": "Set Min",
                "value": "SetMin",
                "type": "number",
                "required": true,
                "rows": null
            },
            {
                "label": "Set Max",
                "value": "SetMax",
                "type": "number",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "SetHH": "",
            "EnableHH": false,
            "SetH": "",
            "EnableH": false,
            "SetL": "",
            "EnableL": false,
            "SetLL": "",
            "EnableLL": false,
            "SetMin": "",
            "SetMax": ""
        },
        "payload": "",
        "submit": "Send/Clouse",
        "cancel": "",
        "topic": "topic",
        "topicType": "str",
        "splitLayout": true,
        "className": "",
        "x": 600,
        "y": 220,
        "wires": [
            [
                "ba583c5f48df3905",
                "27ece5b8978544b2"
            ]
        ]
    },
    {
        "id": "743b223254bc5cb1",
        "type": "ui_ui_control",
        "z": "a9cd65b1c67ffc15",
        "name": "",
        "events": "all",
        "x": 1020,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "c9eae6cebc129e92",
        "type": "sqlite",
        "z": "a9cd65b1c67ffc15",
        "mydb": "8a9376f64511d022",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "Write SQL",
        "x": 1080,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "9fc9832d89df39e7",
        "type": "template",
        "z": "3b30c3f369fbd9c7",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!DOCTYPE html>\n<html>\n\n<body>\n    {{#payload}}\n\n     <div class=\"portada\">\n        <img src=\"data:image/png;base64,{{LOGO}}\" alt=\"img\">\n        <h2 class=\"h2_label\" >TIQUETE DE MEDICIÓN GLP SEGÚN NORMA API MPMS 12.2.2</h2>\n        <h3 class=\"h3_label\" >DEPARTAMENTO PLANTA DE GAS -  CAMPO DE PRODUCCIÓN PAYOA</h3>\n     </div>   \n\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Timestamp</div>\n            <div>{{ timestamp }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Product</div>\n            <div>{{ producto }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Observed Relative Density</div>\n            <div>{{ den_rel_observada }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Observed Temperature (°C)</div>\n            <div>{{ temperatura_observada }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Vapor Pressure (kPa)</div>\n            <div>{{ presion_vapor }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Equilibrium Pressure (kPa)</div>\n            <div>{{ presion_equilibriorio }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Pulses</div>\n            <div>{{ pulsos }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">M Factor</div>\n            <div>{{ m_facot }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">K Factor</div>\n            <div>{{ k_factor }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Average Temperature (°C)</div>\n            <div>{{ tem_prom }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Average Pressure (kPa)</div>\n            <div>{{ presion_promedio }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Relative Density at 60°F</div>\n            <div>{{ den_rela_60 }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">API Gravity</div>\n            <div>{{ gravedad_api }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">CTL Factor</div>\n            <div>{{ ctl_factor }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">CPL Factor</div>\n            <div>{{ cpl_facto }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">CCP</div>\n            <div>{{ ccp }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Indicated Volume (m³)</div>\n            <div>{{ volumen_indicado }}</div>\n        </div>\n        <div class=\"report-item\">\n            <div class=\"report-item-label\">Net Volume (m³)</div>\n            <div>{{ volumen_neto }}</div>\n        </div>\n    \n    <div class=\"footer\">\n        <p>Fecha y Hora Inicio: {{fecha_hora_inicio}}</p>\n        <p>Fecha y Hora Final : {{fecha_hora_fin}}</p>\n        <p>Bache Numero: {{tiquete_no}}</p>\n    </div>\n    {{/payload}}\n</body>\n</html>",
        "output": "str",
        "x": 760,
        "y": 120,
        "wires": [
            [
                "59a6c755075934c4",
                "fe2bd8083c774d93"
            ]
        ]
    },
    {
        "id": "59a6c755075934c4",
        "type": "function",
        "z": "3b30c3f369fbd9c7",
        "name": "function 55",
        "func": "msg.filename=\"/data/db/pdf/\" +msg.topic+\"Reporte.pdf\"\n\nmsg.options = {\n                \"height\": \"10.5in\",\n                \"width\": \"8in\",         \n  \n                \"format\": \"Letter\",\n                \"border\": {\n                    \"top\": \"1in\",           \n                    \"right\": \"0.5in\",\n                    \"bottom\": \"1in\",\n                    \"left\": \"0.5in\"\n                },\n   \n};\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 950,
        "y": 120,
        "wires": [
            [
                "0be581fd40a85b2a"
            ]
        ]
    },
    {
        "id": "a010917be6f3f18c",
        "type": "inject",
        "z": "3b30c3f369fbd9c7",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "71cf588f2a3620dc",
                "fdef3c7280659944"
            ]
        ]
    },
    {
        "id": "d646588b6cea77ac",
        "type": "debug",
        "z": "3b30c3f369fbd9c7",
        "name": "debug 5",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 280,
        "wires": []
    },
    {
        "id": "71cf588f2a3620dc",
        "type": "file in",
        "z": "3b30c3f369fbd9c7",
        "name": "GetLogo",
        "filename": "/data/imgs/petrosantander.png",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 290,
        "y": 60,
        "wires": [
            [
                "2dc35963aaf05ebb"
            ]
        ]
    },
    {
        "id": "2dc35963aaf05ebb",
        "type": "function",
        "z": "3b30c3f369fbd9c7",
        "name": "function 60",
        "func": "global.set(\"LOGO_PETRO\", msg.payload);\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "fe2bd8083c774d93",
        "type": "ui_template",
        "z": "3b30c3f369fbd9c7",
        "group": "42b15aafb8d1be1d",
        "name": "",
        "order": 2,
        "width": 26,
        "height": 16,
        "format": "<style>\n    \n    .report-item {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            grid-gap: 8px;\n            margin-bottom: 16px;\n        }\n    \n    .report-item-label {\n            font-weight: bold;\n    }\n    img {\n        width: 200px; /* Adjust the width according to your logo */\n        margin-bottom: 20px;\n    }\n\n    .h3_label{\n        margin-left: 2px;\n        text-align: center;\n    }\n    .h2_label {\n        margin-left: 2px;\n        text-align: center;\n    }\n    .portada {\n    display: grid;\n    grid-template-columns: 1fr 3fr;\n    margin-left: 5px;\n    grid-gap: 3px;\n    }\n \n</style>\n\n\n<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 940,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "0be581fd40a85b2a",
        "type": "html-to-pdf",
        "z": "3b30c3f369fbd9c7",
        "name": "",
        "format": "A4",
        "zoom": 100,
        "orientation": "Portrait",
        "width": "",
        "height": "",
        "widthUnit": "cm",
        "heightUnit": "cm",
        "marginTop": 1,
        "marginLeft": 1,
        "marginBottom": 1,
        "marginRight": 1,
        "marginTopUnits": "cm",
        "marginLeftUnits": "cm",
        "marginBottomUnits": "cm",
        "marginRightUnits": "cm",
        "omitBackground": false,
        "printGraphics": true,
        "x": 1130,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "79d434158734f0d2",
        "type": "function",
        "z": "3b30c3f369fbd9c7",
        "name": "Processedata",
        "func": "let buffer_img=global.get(\"LOGO_PETRO\");\nlet base64Image = buffer_img.toString('base64');\nlet datos=msg.payload[0];\n\nlet test=\"\";\n\nlet data= msg.payload={\n    ...msg.payload[0],\n    \"LOGO\" : base64Image\n}\n\n\nlet file_date=  \"2022-07-04T12 \"+ \".pdf\";\nmsg.topic=file_date;\n\n\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 120,
        "wires": [
            [
                "9fc9832d89df39e7",
                "d646588b6cea77ac"
            ]
        ]
    },
    {
        "id": "f3233b5bf01aaaaa",
        "type": "postgresql",
        "z": "3b30c3f369fbd9c7",
        "name": "",
        "query": "",
        "postgreSQLConfig": "a5843e127eb4f722",
        "split": false,
        "rowsPerMsg": 1,
        "outputs": 1,
        "x": 490,
        "y": 280,
        "wires": [
            [
                "79d434158734f0d2"
            ]
        ]
    },
    {
        "id": "fdef3c7280659944",
        "type": "function",
        "z": "3b30c3f369fbd9c7",
        "name": "GetBach",
        "func": "\n\nmsg.query=\"SELECT * FROM tbl_bache ORDER BY ID desc LIMIT 2;\"\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 280,
        "wires": [
            [
                "f3233b5bf01aaaaa"
            ]
        ]
    },
    {
        "id": "eac9e8a914c111af",
        "type": "inject",
        "z": "1cc0ca82ef3a0a9b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 150,
        "y": 240,
        "wires": [
            [
                "85b1eb58388d9ced"
            ]
        ]
    },
    {
        "id": "d24d0b9dfbc072b6",
        "type": "switch",
        "z": "1cc0ca82ef3a0a9b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 430,
        "y": 240,
        "wires": [
            [
                "0b3c4b95d26301ac"
            ]
        ]
    },
    {
        "id": "85b1eb58388d9ced",
        "type": "rbe",
        "z": "1cc0ca82ef3a0a9b",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 270,
        "y": 240,
        "wires": [
            [
                "d24d0b9dfbc072b6"
            ]
        ]
    },
    {
        "id": "0b3c4b95d26301ac",
        "type": "function",
        "z": "1cc0ca82ef3a0a9b",
        "name": "Read TAGs",
        "func": "msg.topic = `SELECT * FROM tblTags`;\n\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 610,
        "y": 240,
        "wires": [
            [
                "4b6aa616953defb9"
            ]
        ]
    },
    {
        "id": "d98188d5e0098945",
        "type": "function",
        "z": "1cc0ca82ef3a0a9b",
        "name": "function 53",
        "func": "let tags=msg.payload;\n\n\nfor (let index = 0; index < tags.length; index++) {\n    const element = tags[index];\n    global.set(element.TagName,element);\n}\n\nmsg.payload = msg.payload[0]\nreturn msg;",
        "outputs": 1,
        "timeout": "",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 970,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "850d2e0b0f5c9b99",
        "type": "debug",
        "z": "1cc0ca82ef3a0a9b",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 970,
        "y": 260,
        "wires": []
    },
    {
        "id": "4b6aa616953defb9",
        "type": "sqlite",
        "z": "1cc0ca82ef3a0a9b",
        "mydb": "8a9376f64511d022",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "SQLITE",
        "x": 780,
        "y": 240,
        "wires": [
            [
                "d98188d5e0098945",
                "850d2e0b0f5c9b99"
            ]
        ]
    },
    {
        "id": "20c7e469f2a9eb90",
        "type": "influxdb out",
        "z": "8b7a3cc1bad4cf4b",
        "influxdb": "9d0d97191e966daa",
        "name": "",
        "measurement": "Analogs_in",
        "precision": "",
        "retentionPolicy": "",
        "database": "database",
        "precisionV18FluxV20": "ms",
        "retentionPolicyV18Flux": "",
        "org": "petrosantander",
        "bucket": "terminal-galan",
        "x": 550,
        "y": 220,
        "wires": []
    },
    {
        "id": "d99278a352233beb",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "Influx db",
        "func": "let pit_1001=global.get(\"PIT_1001\");\n\nmsg.payload={\n    PIT_1001 : pit_1001.PV,\n    PIT_2001:10.1,\n    TIT_2001:68.0,\n    FQI_2001:105.3,\n    DIT_2001:0.804\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 220,
        "wires": [
            [
                "20c7e469f2a9eb90"
            ]
        ]
    },
    {
        "id": "trigger_report",
        "type": "inject",
        "z": "8b7a3cc1bad4cf4b",
        "name": "1s",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 70,
        "y": 300,
        "wires": [
            [
                "2566421c9339834c",
                "e75f68bd4838d529"
            ]
        ]
    },
    {
        "id": "bcca226443c09e0c",
        "type": "switch",
        "z": "8b7a3cc1bad4cf4b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 610,
        "y": 340,
        "wires": [
            [
                "468edd549bbcf9d6"
            ]
        ]
    },
    {
        "id": "468edd549bbcf9d6",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "function 3",
        "func": "// Obtener datos\nvar producto = flow.get(\"producto_seleccionado\") || \"butano\";\nvar tiket_number = global.get(\"TIKET_N\") || 0;\nvar estado_batch = global.get(\"ESTADO_BATCH\") || 0;\n\n// Verificar que el batch esté pausado\nif (estado_batch === 1) {\n    node.warn(\"⚠️ El batch debe estar PAUSADO antes de generar el tiquete\");\n    node.status({fill: \"red\", shape: \"ring\", text: \"Batch activo\"});\n    return null;\n}\n\n// Verificar que haya datos en el batch\nvar butano = global.get(\"BUTANO\") || {};\nvar propano = global.get(\"PROPANO\") || {};\n\nvar datos_producto = producto === \"butano\" ? butano : propano;\n\nif (!datos_producto.batch || datos_producto.batch === 0) {\n    node.warn(\"⚠️ No hay datos en el batch para generar tiquete\");\n    node.status({fill: \"yellow\", shape: \"ring\", text: \"Batch vacío\"});\n    return null;\n}\n\nvar pit_2001 = global.get(\"PIT_2001\") || {PV: 0};\nvar tit_2001 = global.get(\"TIT_2001\") || {PV: 0};\n\n// Calcular datos\nvar volumen_litros = datos_producto.batch || 0;\nvar densidad = datos_producto.densidad || 0;\nvar peso_kg = (volumen_litros * densidad / 1000).toFixed(2);\nvar volumen_m3 = (volumen_litros / 1000).toFixed(3);\n\n// Fecha\nvar fecha = new Date();\nvar year = fecha.getFullYear();\nvar mes = String(fecha.getMonth() + 1).padStart(2, '0');\nvar dia = String(fecha.getDate()).padStart(2, '0');\nvar horas = String(fecha.getHours()).padStart(2, '0');\nvar minutos = String(fecha.getMinutes()).padStart(2, '0');\nvar segundos = String(fecha.getSeconds()).padStart(2, '0');\nvar fecha_string = dia + \"-\" + mes + \"-\" + year + \" \" + horas + \":\" + minutos + \":\" + segundos;\nvar fecha_iso = fecha.toISOString();\n\n// Preparar objeto tiquete\nvar tiquete = {\n    numero: tiket_number,\n    fecha: fecha_string,\n    producto: producto.toUpperCase(),\n    operador: \"Sistema Automatizado\",\n    observaciones: \"Recepción automatizada - Sin observaciones\",\n    datos: {\n        volumen_litros: volumen_litros,\n        volumen_m3: volumen_m3,\n        densidad: densidad,\n        peso_kg: peso_kg,\n        temperatura: datos_producto.temperatura || tit_2001.PV || 0,\n        presion: datos_producto.presion || pit_2001.PV || 0,\n        flujo_promedio: datos_producto.flujo || 0\n    }\n};\n\n// Guardar en flow para otros nodos\nflow.set(\"ultimo_tiquete\", tiquete);\nflow.set(\"ultimo_tiquete_fecha_iso\", fecha_iso);\n\n// Preparar mensaje para SQLite\nmsg.topic = `\n    INSERT INTO tiquetes (\n        numero_tiquete, fecha_hora, producto,\n        volumen_litros, volumen_m3, densidad, peso_kg,\n        temperatura, presion, flujo_promedio,\n        operador, observaciones\n    ) VALUES (\n        ${tiket_number},\n        '${fecha_iso}',\n        '${producto.toUpperCase()}',\n        ${volumen_litros},\n        ${volumen_m3},\n        ${densidad},\n        ${peso_kg},\n        ${datos_producto.temperatura || tit_2001.PV || 0},\n        ${datos_producto.presion || pit_2001.PV || 0},\n        ${datos_producto.flujo || 0},\n        'Sistema Automatizado',\n        'Recepción automatizada'\n    )\n`;\n\nmsg.payload = tiquete;\n\nnode.status({fill: \"blue\", shape: \"dot\", text: `Preparando #${tiket_number}`});\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 340,
        "wires": [
            [
                "9e70c9c0ba72e9ce"
            ]
        ]
    },
    {
        "id": "2566421c9339834c",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "function 6",
        "func": "let is_report=global.get(\"IS_REPORT\");\nif(is_report==true)\n{\n    global.set(\"IS_REPORT\",false);\n    msg.payload=1;\n}else {\n    msg.payload=0;\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 260,
        "y": 340,
        "wires": [
            [
                "778a7d2da84638d1"
            ]
        ]
    },
    {
        "id": "9e70c9c0ba72e9ce",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "Preparar HTTP Request",
        "func": "// El tiquete viene del flow\nvar tiquete = flow.get(\"ultimo_tiquete\");\n\nif (!tiquete) {\n    node.error(\"No hay tiquete para generar PDF\");\n    return null;\n}\n\n// Preparar petición HTTP\nmsg.url = \"http://modbus-simulator:8080/generar_pdf\";\nmsg.method = \"POST\";\nmsg.headers = {\n    \"Content-Type\": \"application/json\"\n};\nmsg.payload = tiquete;\n\nnode.status({fill: \"blue\", shape: \"ring\", text: \"Generando PDF...\"});\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1030,
        "y": 340,
        "wires": [
            [
                "307d6c91173716f4",
                "13a38f9de199c4f0"
            ]
        ]
    },
    {
        "id": "c1c9974097efedeb",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "Get Request",
        "func": "// msg.payload contiene la respuesta del servidor\nif (msg.payload && msg.payload.success) {\n    node.status({ fill: \"green\", shape: \"dot\", text: \"PDF generado\" });\n\n    var tiquete = flow.get(\"ultimo_tiquete\");\n    var tiket_number = tiquete.numero;\n\n    // Preparar mensaje para actualizar SQLite con la ruta del PDF\n    var msgUpdate = {\n        topic: `UPDATE tiquetes SET archivo_pdf = '${msg.payload.filepath}' WHERE numero_tiquete = ${tiket_number}`\n    };\n\n    // Mensaje para mostrar el tiquete en la UI\n    var msgDisplay = {\n        topic: \"tiquete_generado\",\n        payload: tiquete\n    };\n\n    // Mensaje de confirmación para debug\n    var msgDebug = {\n        payload: {\n            mensaje: `Tiquete #${tiket_number} generado exitosamente`,\n            pdf: msg.payload.filename,\n            ruta: msg.payload.filepath\n        }\n    };\n\n    return [msgUpdate, msgDisplay, msgDebug];\n} else {\n    var error = msg.payload && msg.payload.error ? msg.payload.error : \"Error desconocido\";\n    node.error(\"Error generando PDF: \" + error);\n    node.status({ fill: \"red\", shape: \"ring\", text: \"Error PDF\" });\n\n    // Enviar mensaje de error para mostrar al usuario\n    var msgError = {\n        topic: \"error_tiquete\",\n        payload: {\n            error: true,\n            mensaje: \"Error generando PDF: \" + error\n        }\n    };\n\n    return [null, null, msgError];\n}",
        "outputs": 3,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1510,
        "y": 340,
        "wires": [
            [
                "c1579f6f9f8c6c93"
            ],
            [
                "49f3dd96ede29c5e"
            ],
            [
                "15901f4989eb6b5d"
            ]
        ]
    },
    {
        "id": "15901f4989eb6b5d",
        "type": "debug",
        "z": "8b7a3cc1bad4cf4b",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1720,
        "y": 400,
        "wires": []
    },
    {
        "id": "307d6c91173716f4",
        "type": "http request",
        "z": "8b7a3cc1bad4cf4b",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "http://localhost:8080/generar_pdf",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1270,
        "y": 340,
        "wires": [
            [
                "c1c9974097efedeb"
            ]
        ]
    },
    {
        "id": "c1579f6f9f8c6c93",
        "type": "sqlite",
        "z": "8b7a3cc1bad4cf4b",
        "mydb": "8a9376f64511d022",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "SQLITE",
        "x": 1720,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "49f3dd96ede29c5e",
        "type": "ui_template",
        "z": "8b7a3cc1bad4cf4b",
        "group": "f5490ef343d6cb98",
        "name": "",
        "order": 6,
        "width": 1,
        "height": 1,
        "format": "<style>\n    .tiquete-container {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.8);\n        z-index: 10000;\n        justify-content: center;\n        align-items: center;\n    }\n    \n    .tiquete-container.show {\n        display: flex;\n    }\n    \n    .tiquete-paper {\n        background: white;\n        width: 850px;\n        max-height: 90vh;\n        overflow-y: auto;\n        padding: 40px;\n        border-radius: 10px;\n        box-shadow: 0 10px 40px rgba(0,0,0,0.5);\n        font-family: Arial, sans-serif;\n    }\n    \n    .tiquete-header {\n        text-align: center;\n        border-bottom: 3px double #000;\n        padding-bottom: 20px;\n        margin-bottom: 20px;\n    }\n    \n    .tiquete-title {\n        font-size: 24px;\n        font-weight: bold;\n        margin-bottom: 10px;\n        color: #000;\n    }\n    \n    .tiquete-subtitle {\n        font-size: 14px;\n        color: #333;\n        font-weight: bold;\n    }\n    \n    .tiquete-info {\n        margin: 20px 0;\n    }\n    \n    .info-row {\n        display: flex;\n        justify-content: space-between;\n        padding: 10px 0;\n        border-bottom: 1px dotted #999;\n    }\n    \n    .info-label {\n        font-weight: bold;\n        width: 40%;\n        color: #333;\n        font-size: 14px;\n    }\n    \n    .info-value {\n        width: 60%;\n        text-align: right;\n        color: #000;\n        font-size: 14px;\n        font-weight: 600;\n    }\n    \n    .tiquete-data {\n        margin: 30px 0;\n        background: #e8f4f8;\n        padding: 20px;\n        border-radius: 5px;\n        border: 2px solid #3498db;\n    }\n    \n    .data-title {\n        font-size: 18px;\n        font-weight: bold;\n        margin-bottom: 15px;\n        color: #2c3e50;\n        text-align: center;\n        background: #3498db;\n        color: white;\n        padding: 10px;\n        border-radius: 4px;\n        margin: -20px -20px 15px -20px;\n    }\n    \n    .data-row {\n        display: flex;\n        justify-content: space-between;\n        padding: 8px 0;\n        border-bottom: 1px dotted #aaa;\n    }\n    \n    .data-label {\n        font-weight: bold;\n        color: #2c3e50;\n        font-size: 13px;\n    }\n    \n    .data-value {\n        color: #000;\n        font-weight: bold;\n        font-size: 13px;\n    }\n    \n    .tiquete-footer {\n        margin-top: 40px;\n        padding-top: 20px;\n        border-top: 2px solid #000;\n    }\n    \n    .observaciones-label {\n        font-weight: bold;\n        margin-bottom: 10px;\n        color: #000;\n        font-size: 14px;\n    }\n    \n    .observaciones-box {\n        min-height: 60px;\n        border: 2px solid #666;\n        padding: 10px;\n        margin-top: 5px;\n        border-radius: 4px;\n        background: #f9f9f9;\n        color: #333;\n        font-size: 13px;\n    }\n    \n    .firma-section {\n        display: flex;\n        justify-content: space-around;\n        margin-top: 60px;\n    }\n    \n    .firma-box {\n        text-align: center;\n        width: 40%;\n    }\n    \n    .firma-line {\n        border-top: 2px solid #000;\n        margin: 50px 0 10px 0;\n    }\n    \n    .firma-label {\n        font-size: 12px;\n        color: #000;\n        font-weight: bold;\n    }\n    \n    .btn-actions {\n        display: flex;\n        gap: 15px;\n        margin-top: 30px;\n        justify-content: center;\n    }\n    \n    .btn-print {\n        padding: 14px 40px;\n        background: #27ae60;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 16px;\n        font-weight: bold;\n        cursor: pointer;\n        box-shadow: 0 4px 6px rgba(0,0,0,0.2);\n        transition: all 0.2s;\n    }\n    \n    .btn-print:hover {\n        background: #229954;\n        transform: translateY(-2px);\n        box-shadow: 0 6px 8px rgba(0,0,0,0.3);\n    }\n    \n    .btn-close {\n        padding: 14px 40px;\n        background: #e74c3c;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 16px;\n        font-weight: bold;\n        cursor: pointer;\n        box-shadow: 0 4px 6px rgba(0,0,0,0.2);\n        transition: all 0.2s;\n    }\n    \n    .btn-close:hover {\n        background: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 6px 8px rgba(0,0,0,0.3);\n    }\n    \n    @media print {\n        .btn-actions {\n            display: none;\n        }\n        .tiquete-container {\n            background: white;\n            display: block !important;\n        }\n        .tiquete-paper {\n            box-shadow: none;\n            max-height: none;\n            width: 100%;\n        }\n    }\n</style>\n\n<div id=\"tiquete-container\" class=\"tiquete-container\">\n    <div class=\"tiquete-paper\">\n        <div class=\"tiquete-header\">\n            <div class=\"tiquete-title\">TIQUETE DE RECEPCIÓN DE GLP</div>\n        </div>\n        \n        <div class=\"tiquete-info\">\n            <div class=\"info-row\">\n                <span class=\"info-label\">Tiquete No.:</span>\n                <span class=\"info-value\" id=\"tiq-numero\">-</span>\n            </div>\n            <div class=\"info-row\">\n                <span class=\"info-label\">Fecha y Hora:</span>\n                <span class=\"info-value\" id=\"tiq-fecha\">-</span>\n            </div>\n            <div class=\"info-row\">\n                <span class=\"info-label\">Producto:</span>\n                <span class=\"info-value\" id=\"tiq-producto\">-</span>\n            </div>\n            <div class=\"info-row\">\n                <span class=\"info-label\">Operador:</span>\n                <span class=\"info-value\" id=\"tiq-operador\">Sistema Automatizado</span>\n            </div>\n        </div>\n        \n        <div class=\"tiquete-data\">\n            <div class=\"data-title\">DATOS DE RECEPCIÓN</div>\n            \n            <div class=\"data-row\">\n                <span class=\"data-label\">Volumen (Litros):</span>\n                <span class=\"data-value\" id=\"tiq-vol-litros\">-</span>\n            </div>\n            <div class=\"data-row\">\n                <span class=\"data-label\">Volumen (m³):</span>\n                <span class=\"data-value\" id=\"tiq-vol-m3\">-</span>\n            </div>\n            <div class=\"data-row\">\n                <span class=\"data-label\">Densidad (kg/m³):</span>\n                <span class=\"data-value\" id=\"tiq-densidad\">-</span>\n            </div>\n            <div class=\"data-row\">\n                <span class=\"data-label\">Peso Neto (kg):</span>\n                <span class=\"data-value\" id=\"tiq-peso\">-</span>\n            </div>\n            <div class=\"data-row\">\n                <span class=\"data-label\">Temperatura (°F):</span>\n                <span class=\"data-value\" id=\"tiq-temperatura\">-</span>\n            </div>\n            <div class=\"data-row\">\n                <span class=\"data-label\">Presión (PSI):</span>\n                <span class=\"data-value\" id=\"tiq-presion\">-</span>\n            </div>\n            <div class=\"data-row\" style=\"border-bottom: none;\">\n                <span class=\"data-label\">Flujo Promedio (m³/h):</span>\n                <span class=\"data-value\" id=\"tiq-flujo\">-</span>\n            </div>\n        </div>\n        \n        <div class=\"tiquete-footer\">\n            <div class=\"observaciones-label\">Observaciones:</div>\n            <div id=\"tiq-observaciones\" class=\"observaciones-box\">\n                Recepción automatizada - Sin observaciones\n            </div>\n            \n            <div class=\"firma-section\">\n                <div class=\"firma-box\">\n                    <div class=\"firma-line\"></div>\n                    <div class=\"firma-label\">Entregado por</div>\n                </div>\n                <div class=\"firma-box\">\n                    <div class=\"firma-line\"></div>\n                    <div class=\"firma-label\">Recibido por</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"btn-actions\">\n            <button class=\"btn-print\" onclick=\"imprimirTiquete()\">\n                🖨️ Imprimir\n            </button>\n            <button class=\"btn-close\" onclick=\"cerrarTiquete()\">\n                ✖️ Cerrar\n            </button>\n        </div>\n    </div>\n</div>\n\n\n<script>\n(function(scope) {\n    \n    // Escuchar mensajes de Node-RED\n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            if (msg.topic === 'tiquete_generado') {\n                mostrarTiquete(msg.payload);\n            } else if (msg.topic === 'error_tiquete') {\n                mostrarError(msg.payload.mensaje);\n            }\n        }\n    });\n    \n    window.mostrarTiquete = function(tiquete) {\n        console.log('Mostrando tiquete:', tiquete);\n        \n        // Rellenar datos\n        document.getElementById('tiq-numero').textContent = tiquete.numero;\n        document.getElementById('tiq-fecha').textContent = tiquete.fecha;\n        document.getElementById('tiq-producto').textContent = tiquete.producto;\n        document.getElementById('tiq-vol-litros').textContent = Number(tiquete.datos.volumen_litros).toLocaleString('es-CO') + ' L';\n        document.getElementById('tiq-vol-m3').textContent = tiquete.datos.volumen_m3 + ' m³';\n        document.getElementById('tiq-densidad').textContent = Number(tiquete.datos.densidad).toFixed(2) + ' kg/m³';\n        document.getElementById('tiq-peso').textContent = tiquete.datos.peso_kg + ' kg';\n        document.getElementById('tiq-temperatura').textContent = Number(tiquete.datos.temperatura).toFixed(1) + ' °F';\n        document.getElementById('tiq-presion').textContent = Number(tiquete.datos.presion).toFixed(1) + ' PSI';\n        document.getElementById('tiq-flujo').textContent = Number(tiquete.datos.flujo_promedio).toFixed(1) + ' m³/h';\n        \n        if (tiquete.observaciones) {\n            document.getElementById('tiq-observaciones').textContent = tiquete.observaciones;\n        }\n        \n        // Mostrar el tiquete\n        document.getElementById('tiquete-container').classList.add('show');\n    };\n    \n    window.mostrarError = function(mensaje) {\n        var errorContainer = document.getElementById('error-container');\n        var errorMessage = document.getElementById('error-message');\n        \n        errorMessage.textContent = mensaje;\n        errorContainer.style.display = 'block';\n        \n        // Ocultar después de 5 segundos\n        setTimeout(function() {\n            errorContainer.style.display = 'none';\n        }, 5000);\n    };\n    \n    window.imprimirTiquete = function() {\n        window.print();\n    };\n    \n    window.cerrarTiquete = function() {\n        document.getElementById('tiquete-container').classList.remove('show');\n    };\n    \n    // Función global para abrir desde SVG o botón\n    window.generarTiquete = function() {\n        console.log('Solicitando generación de tiquete...');\n        scope.send({\n            payload: true,\n            topic: 'generar_tiquete'\n        });\n    };\n    \n    // Cerrar con ESC\n    document.addEventListener('keydown', function(event) {\n        if (event.key === 'Escape') {\n            cerrarTiquete();\n        }\n    });\n    \n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1720,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "4eafc0aef0b22ada",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "function 1",
        "func": "msg.topic=\"SELECT * FROM tblTags\"\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 280,
        "wires": [
            [
                "c91217fb4c9a6fba"
            ]
        ]
    },
    {
        "id": "c91217fb4c9a6fba",
        "type": "sqlite",
        "z": "8b7a3cc1bad4cf4b",
        "mydb": "8a9376f64511d022",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "",
        "x": 760,
        "y": 280,
        "wires": [
            [
                "a779414a34e016b8"
            ]
        ]
    },
    {
        "id": "13a38f9de199c4f0",
        "type": "debug",
        "z": "8b7a3cc1bad4cf4b",
        "name": "debug 6",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1180,
        "y": 280,
        "wires": []
    },
    {
        "id": "a779414a34e016b8",
        "type": "function",
        "z": "8b7a3cc1bad4cf4b",
        "name": "function 10",
        "func": "let tags=msg.payload;\n\ntags.forEach(function(tag) {\n    global.set(tag.TagName,tag);\n});\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 990,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "6692bf8ad08488bf",
        "type": "switch",
        "z": "8b7a3cc1bad4cf4b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 370,
        "y": 280,
        "wires": [
            [
                "4eafc0aef0b22ada"
            ]
        ]
    },
    {
        "id": "778a7d2da84638d1",
        "type": "rbe",
        "z": "8b7a3cc1bad4cf4b",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 430,
        "y": 340,
        "wires": [
            [
                "bcca226443c09e0c"
            ]
        ]
    },
    {
        "id": "e75f68bd4838d529",
        "type": "rbe",
        "z": "8b7a3cc1bad4cf4b",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 230,
        "y": 280,
        "wires": [
            [
                "6692bf8ad08488bf"
            ]
        ]
    },
    {
        "id": "12771eacfe1bc3b8",
        "type": "ui_svg_graphics",
        "z": "619addbf2da107aa",
        "group": "f5490ef343d6cb98",
        "order": 1,
        "width": 30,
        "height": 13,
        "svgString": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!-- Created with Inkscape (http://www.inkscape.org/) -->\n\n<svg version=\"1.1\" id=\"svg1\" xml:space=\"preserve\" width=\"1000.5547\" height=\"677.75421\"\n    xmlns:inkscape=\"http://www.inkscape.org/namespaces/inkscape\"\n    xmlns:sodipodi=\"http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns=\"http://www.w3.org/2000/svg\" xmlns:svg=\"http://www.w3.org/2000/svg\">\n    <defs id=\"defs1\">\n        <linearGradient class=\"linear\" id=\"SVGID_1_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"23.924\" y1=\"95.863899\"\n            x2=\"23.924\" y2=\"58.4035\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop5-7\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop6-5\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_2_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"75.825996\" y1=\"95.863899\"\n            x2=\"75.825996\" y2=\"58.4035\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop7-9\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop8-2\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_3_valve\" gradientUnits=\"userSpaceOnUse\" x1=\"42.25\" y1=\"77.133698\"\n            x2=\"54.75\" y2=\"77.133698\">\n\n\n            <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop9-2\" />\n            <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop10-8\" />\n        </linearGradient>\n        <linearGradient inkscape:collect=\"always\" xlink:href=\"#linearGradient22\" id=\"linearGradient24\"\n            gradientUnits=\"userSpaceOnUse\" gradientTransform=\"matrix(2.5279862,0,0,0.08719459,-456.19512,146.57537)\"\n            x1=\"258.21692\" y1=\"72.793594\" x2=\"258.21692\" y2=\"138.89528\" />\n        <linearGradient id=\"linearGradient22\" inkscape:collect=\"always\">\n            <stop style=\"stop-color:#e65309;stop-opacity:0.99052501;\" offset=\"0\" id=\"stop22\" />\n            <stop style=\"stop-color:#f0f3f5;stop-opacity:0.98039216;\" offset=\"0.5\" id=\"stop24\" />\n            <stop style=\"stop-color:#e17313;stop-opacity:0.96796471;\" offset=\"1\" id=\"stop23\" />\n        </linearGradient>\n        <linearGradient inkscape:collect=\"always\" xlink:href=\"#linearGradient22\" id=\"linearGradient23\" x1=\"258.21692\"\n            y1=\"72.793594\" x2=\"258.21692\" y2=\"138.89528\" gradientUnits=\"userSpaceOnUse\"\n            gradientTransform=\"matrix(1.0297782,0,0,0.08774044,-216.83092,146.32043)\" />\n        <linearGradient id=\"linearGradient3\" inkscape:collect=\"always\">\n            <stop style=\"stop-color:#e65309;stop-opacity:0.99052501;\" offset=\"0\" id=\"stop1\" />\n            <stop style=\"stop-color:#f0f3f5;stop-opacity:0.98039216;\" offset=\"0.5\" id=\"stop2\" />\n            <stop style=\"stop-color:#e17313;stop-opacity:0.96796471;\" offset=\"1\" id=\"stop3\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_1_massflowmeter\" gradientUnits=\"userSpaceOnUse\" x1=\"50.138401\"\n            y1=\"86.6707\" x2=\"50.138401\" y2=\"71.114403\">\n\n\n            <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop4\" />\n            <stop offset=\"1\" stop-color=\"#000000\" id=\"stop5\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_2_massflowmeter\" gradientUnits=\"userSpaceOnUse\" x1=\"72.862198\"\n            y1=\"58.882999\" x2=\"83.862198\" y2=\"47.882999\">\n\n\n            <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop6\" />\n            <stop offset=\"1\" stop-color=\"#000000\" id=\"stop7\" />\n        </linearGradient>\n        <linearGradient class=\"linear\" id=\"SVGID_3_massflowmeter\" gradientUnits=\"userSpaceOnUse\" x1=\"27.6476\"\n            y1=\"58.456501\" x2=\"16.314199\" y2=\"47.789902\">\n\n\n            <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop8\" />\n            <stop offset=\"1\" stop-color=\"#000000\" id=\"stop9\" />\n        </linearGradient>\n    </defs>\n    <sodipodi:namedview id=\"namedview1\" pagecolor=\"#ffffff\" bordercolor=\"#000000\" borderopacity=\"0.25\"\n        inkscape:showpageshadow=\"2\" inkscape:pageopacity=\"0.0\" inkscape:pagecheckerboard=\"0\"\n        inkscape:deskcolor=\"#d1d1d1\" />\n    <inkscape:clipboard min=\"57.196137,69.251793\" max=\"1057.7508,747.00599\" geom-min=\"57.340988,69.923696\"\n        geom-max=\"1057.5246,747.00599\" />\n    <g id=\"g9\" transform=\"matrix(3.7795276,0,0,3.7795276,-57.196138,-69.251794)\">\n        <g id=\"shape\" transform=\"matrix(0.52768025,0,0,0.51488136,71.766172,148.19613)\"\n            style=\"fill:#9d3600;fill-opacity:1\">\n            <path fill=\"#c78163\"\n                d=\"m 67.676,31.745 -8.292,-0.622 -3.128,-3.128 0.651,-3.817 c 2.004,-0.37 3.408,-1.164 3.408,-2.086 0,-1.108 1.851,-2.141 4.297,-2.495 2.346,0 11.757,0 11.91,0 0.64,0 1.159,-2.118 1.159,-4.732 0,-2.614 -0.519,-4.732 -1.159,-4.732 -0.153,0 -9.563,0 -11.91,0 -2.446,-0.354 -4.298,-1.387 -4.298,-2.495 0,-1.271 -2.655,-2.311 -5.899,-2.311 h -8.259 c -3.245,0 -5.899,1.04 -5.899,2.311 0,1.108 -1.952,2.142 -4.532,2.495 -3.361,0 -11.291,0 -11.428,0 -0.64,0 -1.159,2.118 -1.159,4.732 0,2.614 0.519,4.732 1.159,4.732 0.137,0 8.068,0 11.428,0 2.58,0.354 4.532,1.387 4.532,2.495 0,0.873 1.266,1.627 3.102,2.02 l 0.662,3.882 -3.127,3.128 -8.292,0.622 L 0.277,64.069 10.332,86.722 H 89.945 L 100,64.069 Z M 80.634,71.149 H 19.643 l -1.359,-3.062 25.33,-25.33 0.356,-4.746 3.191,-3.191 c 1.653,-1.653 4.333,-1.653 5.985,0 l 3.159,3.159 0.359,4.778 25.33,25.33 z\"\n                id=\"path1\" style=\"fill:#9d3600;fill-opacity:1\" />\n            <path fill=\"#c78163\" d=\"m 75.544,24.19 c 0.077,0 4.591,0 4.669,0 V 5.542 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path2\" style=\"fill:#9d3600;fill-opacity:1\" />\n            <path fill=\"#c78163\" d=\"m 20.449,24.19 c 0.077,0 4.591,0 4.669,0 V 5.542 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path3\" style=\"fill:#9d3600;fill-opacity:1\" />\n        </g>\n        <g id=\"linear\" transform=\"matrix(0.56342809,0,0,0.51488136,69.639602,148.19613)\">\n            <linearGradient class=\"linear\" id=\"linearGradient11\" gradientUnits=\"userSpaceOnUse\" x1=\"50.138401\"\n                y1=\"86.6707\" x2=\"50.138401\" y2=\"71.114403\">\n\n\n                <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop10\" />\n                <stop offset=\"1\" stop-color=\"#000000\" id=\"stop11\" />\n            </linearGradient>\n            <polygon class=\"linear\" fill=\"url(#SVGID_1_massflowmeter)\"\n                points=\"19.643,71.149 80.634,71.149 89.945,86.722 10.332,86.722 \" id=\"polygon4\"\n                style=\"fill:url(#SVGID_1_massflowmeter)\" />\n            <linearGradient class=\"linear\" id=\"linearGradient13\" gradientUnits=\"userSpaceOnUse\" x1=\"72.862198\"\n                y1=\"58.882999\" x2=\"83.862198\" y2=\"47.882999\">\n\n\n                <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop12\" />\n                <stop offset=\"1\" stop-color=\"#000000\" id=\"stop13\" />\n            </linearGradient>\n            <polygon class=\"linear\" fill=\"url(#SVGID_2_massflowmeter)\"\n                points=\"81.993,68.087 56.663,42.757 67.676,31.745 100,64.069 \" id=\"polygon6\"\n                style=\"fill:url(#SVGID_2_massflowmeter)\" />\n            <linearGradient class=\"linear\" id=\"linearGradient15\" gradientUnits=\"userSpaceOnUse\" x1=\"27.6476\"\n                y1=\"58.456501\" x2=\"16.314199\" y2=\"47.789902\">\n\n\n                <stop offset=\"0\" stop-color=\"#de9c5f\" id=\"stop14\" />\n                <stop offset=\"1\" stop-color=\"#000000\" id=\"stop15\" />\n            </linearGradient>\n            <polygon class=\"linear\" fill=\"url(#SVGID_3_massflowmeter)\"\n                points=\"0.277,64.069 32.601,31.745 43.613,42.757 18.284,68.087 \" id=\"polygon8\"\n                style=\"fill:url(#SVGID_3_massflowmeter)\" />\n        </g>\n        <g id=\"dark\" transform=\"matrix(0.56342809,0,0,0.51488136,69.639602,148.19613)\">\n            <circle fill=\"#947365\" cx=\"50.138\" cy=\"81.782997\" r=\"12.094\" id=\"circle8\" />\n            <polygon fill=\"#947365\" points=\"10.332,86.722 19.643,71.149 18.284,68.087 0.277,64.069 \" id=\"polygon9\" />\n            <polygon fill=\"#947365\" points=\"100,64.069 81.993,68.087 80.634,71.149 89.945,86.722 \" id=\"polygon10\" />\n        </g>\n        <g id=\"light\" transform=\"matrix(0.56342809,0,0,0.51488136,69.639602,148.19613)\"\n            style=\"fill:#4f4b4c;fill-opacity:1\">\n            <path fill=\"#de9c5f\"\n                d=\"m 50.138,67.526 c -7.874,0 -14.257,6.383 -14.257,14.257 0,7.874 6.383,14.257 14.257,14.257 7.874,0 14.257,-6.383 14.257,-14.257 0,-7.874 -6.383,-14.257 -14.257,-14.257 z m 0,26.351 c -6.679,0 -12.094,-5.415 -12.094,-12.094 0,-6.679 5.415,-12.094 12.094,-12.094 6.679,0 12.094,5.415 12.094,12.094 0,6.679 -5.414,12.094 -12.094,12.094 z\"\n                id=\"path10\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 18.284,68.337 c -0.018,0 -0.036,-0.002 -0.054,-0.006 L 0.223,64.313 c -0.135,-0.03 -0.22,-0.164 -0.19,-0.299 0.03,-0.134 0.163,-0.219 0.298,-0.189 l 18.007,4.018 c 0.135,0.03 0.22,0.164 0.19,0.299 -0.026,0.116 -0.13,0.195 -0.244,0.195 z\"\n                id=\"path11\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 10.332,86.973 c -0.044,0 -0.088,-0.012 -0.128,-0.035 -0.118,-0.071 -0.157,-0.225 -0.086,-0.343 l 9.311,-15.574 c 0.07,-0.121 0.223,-0.157 0.343,-0.087 0.118,0.071 0.157,0.225 0.086,0.343 l -9.311,15.574 c -0.047,0.079 -0.13,0.122 -0.215,0.122 z\"\n                id=\"path12\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 81.993,68.337 c -0.115,0 -0.218,-0.079 -0.244,-0.195 -0.03,-0.135 0.055,-0.269 0.189,-0.299 l 18.007,-4.018 c 0.141,-0.03 0.269,0.056 0.299,0.189 0.03,0.135 -0.055,0.269 -0.189,0.299 l -18.007,4.018 c -0.019,0.004 -0.037,0.006 -0.055,0.006 z\"\n                id=\"path13\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 89.945,86.973 c -0.085,0 -0.168,-0.043 -0.215,-0.122 L 80.418,71.277 c -0.07,-0.118 -0.032,-0.271 0.087,-0.343 0.116,-0.07 0.271,-0.034 0.343,0.087 l 9.312,15.574 c 0.07,0.118 0.032,0.271 -0.087,0.343 -0.04,0.023 -0.084,0.035 -0.128,0.035 z\"\n                id=\"path14\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\" d=\"m 75.544,8.023 c 0.077,0 4.591,0 4.669,0 V 5.542 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path15\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\" d=\"m 20.449,8.023 c 0.077,0 4.591,0 4.669,0 V 5.542 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path16\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 35.725,10.134 c -2.729,0 -8.472,0 -10.607,0 v 1.532 c 2.135,0 7.878,0 10.607,0 2.58,-0.221 4.532,-0.867 4.532,-1.56 V 7.639 c 0,1.109 -1.953,2.142 -4.532,2.495 z\"\n                id=\"path17\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 64.847,10.134 c 2.729,0 8.472,0 10.607,0 v 1.532 c -2.135,0 -7.878,0 -10.607,0 -2.58,-0.221 -4.532,-0.867 -4.532,-1.56 V 7.639 c 0,1.109 1.952,2.142 4.532,2.495 z\"\n                id=\"path18\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <rect x=\"42.813\" y=\"21.833\" fill=\"#de9c5f\" width=\"14.553\" height=\"2.2160001\" id=\"rect18\"\n                style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <path fill=\"#de9c5f\"\n                d=\"m 57.365,5.683 v 5.81 c -1.38,0.092 -2.522,1.017 -2.942,2.276 H 45.765 C 45.354,12.538 44.252,11.628 42.912,11.502 V 5.683 C 41.239,6.092 40.11,6.814 40.11,7.639 v 14.454 c 0,0.825 1.129,1.547 2.802,1.956 v -5.917 c 1.305,-0.122 2.388,-0.987 2.824,-2.169 h 8.716 c 0.446,1.209 1.568,2.088 2.913,2.178 v 5.908 c 1.585,-0.045 2.742,-0.883 2.802,-1.956 V 7.639 c 0,-0.825 -1.128,-1.547 -2.802,-1.956 z\"\n                id=\"path19\" style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <polygon fill=\"#de9c5f\" points=\"32.601,31.745 33.75,33.25 40.893,31.123 \" id=\"polygon19\"\n                style=\"fill:#4f4b4c;fill-opacity:1\" />\n            <polygon fill=\"#de9c5f\" points=\"67.676,31.745 59.384,31.123 66.527,33.25 \" id=\"polygon20\"\n                style=\"fill:#4f4b4c;fill-opacity:1\" />\n        </g>\n        <g id=\"shadow\" transform=\"matrix(0.56342809,0,0,0.51488136,69.639602,148.19613)\">\n            <path fill=\"#000000\"\n                d=\"m 50.138,95.04 c -7.705,0 -13.966,-6.117 -14.232,-13.757 -0.006,0.167 -0.025,0.331 -0.025,0.5 0,7.874 6.383,14.257 14.257,14.257 7.874,0 14.257,-6.383 14.257,-14.257 0,-0.169 -0.019,-0.333 -0.025,-0.5 -0.266,7.641 -6.526,13.757 -14.232,13.757 z\"\n                id=\"path20\" />\n            <path fill=\"#000000\" d=\"m 75.544,24.19 c 0.077,0 4.591,0 4.669,0 v -2.481 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path21\" />\n            <path fill=\"#000000\" d=\"m 20.449,24.19 c 0.077,0 4.591,0 4.669,0 v -2.481 c -0.077,0 -4.591,0 -4.669,0 z\"\n                id=\"path22\" />\n            <path fill=\"#000000\"\n                d=\"m 35.725,19.597 c -2.729,0 -8.472,0 -10.607,0 v -1.532 c 2.135,0 7.878,0 10.607,0 2.58,0.221 4.532,0.867 4.532,1.56 v 2.468 c 0,-1.109 -1.953,-2.142 -4.532,-2.496 z\"\n                id=\"path23\" />\n            <path fill=\"#000000\"\n                d=\"m 64.847,19.597 c 2.729,0 8.472,0 10.607,0 v -1.532 c -2.135,0 -7.878,0 -10.607,0 -2.58,0.221 -4.532,0.867 -4.532,1.56 v 2.468 c 0,-1.109 1.952,-2.142 4.532,-2.496 z\"\n                id=\"path24\" />\n            <path fill=\"#000000\" stroke=\"#808080\" stroke-width=\"0.5\" stroke-miterlimit=\"10\"\n                d=\"m 42.912,18.132 c 1.305,-0.122 2.388,-0.987 2.824,-2.169 h 8.716 c 0.446,1.209 1.568,2.088 2.913,2.178\"\n                id=\"path25\" />\n            <path fill=\"#000000\" stroke=\"#808080\" stroke-width=\"0.5\" stroke-miterlimit=\"10\"\n                d=\"m 40.109,22.093 c 0,0.825 1.129,1.547 2.802,1.956 h 14.454 c 1.585,-0.045 2.742,-0.883 2.802,-1.956\"\n                id=\"path26\" />\n        </g>\n        <g id=\"hlight\" transform=\"matrix(0.56342809,0,0,0.51488136,69.639602,148.19613)\">\n            <rect x=\"42.813\" y=\"21.583\" fill=\"#fbbc5a\" width=\"14.553\" height=\"0.5\" id=\"rect26\" />\n            <path fill=\"#fbbc5a\"\n                d=\"m 50.138,68.526 c 7.705,0 13.966,6.117 14.232,13.757 0.006,-0.167 0.025,-0.331 0.025,-0.5 0,-7.874 -6.383,-14.257 -14.257,-14.257 -7.874,0 -14.257,6.383 -14.257,14.257 0,0.169 0.019,0.333 0.025,0.5 0.266,-7.64 6.527,-13.757 14.232,-13.757 z\"\n                id=\"path27\" />\n            <path fill=\"#fbbc5a\"\n                d=\"m 54.603,14.019 h -9.018 l -0.057,-0.171 c -0.387,-1.16 -1.423,-1.983 -2.639,-2.097 l 0.047,-0.498 c 1.352,0.127 2.513,1.009 3.005,2.266 h 8.307 c 0.506,-1.296 1.704,-2.183 3.102,-2.275 l 0.033,0.499 c -1.255,0.083 -2.323,0.91 -2.722,2.105 z\"\n                id=\"path28\" />\n        </g>\n        <rect style=\"opacity:1;fill:url(#linearGradient23);stroke:#b9b9b9;stroke-width:0.07665;stroke-opacity:1\"\n            id=\"rect21\" width=\"67.807465\" height=\"6.9233499\" x=\"15.17147\" y=\"152.1456\" />\n        <rect style=\"opacity:1;fill:url(#linearGradient24);stroke:#b9b9b9;stroke-width:0.119721;stroke-opacity:1\"\n            id=\"rect24\" width=\"166.45949\" height=\"6.8802786\" x=\"113.34389\" y=\"152.36427\" />\n        <g id=\"g55\" transform=\"matrix(0.86692568,0,0,1.2298261,103.84805,-36.429641)\">\n            <g id=\"shape-8\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\"\n                style=\"fill:#fb5700;fill-opacity:1\">\n                <path fill=\"#e34300\"\n                    d=\"m 94.488,54.267 v 9.427 H 80.995 C 76.955,58.43 70.604,55.033 63.456,55.033 h -4.672 v -4.03 H 66.19 V 38.002 H 84.306 V 36.5 H 86.5 V 33 h -2.194 v -1.877 h 1.416 c 1.833,0 3.334,-1.5 3.334,-3.334 V 10.381 c 0,-1.833 -1.5,-3.333 -3.334,-3.333 H 84.306 V 5.25 H 86.5 V 1.75 H 84.306 V 0.169 h -69 V 1.75 H 13 v 3.5 h 2.306 V 7.048 H 13.89 c -1.833,0 -3.334,1.5 -3.334,3.333 V 27.79 c 0,1.833 1.5,3.334 3.334,3.334 h 1.416 V 33 H 13 v 3.5 h 2.306 v 1.502 h 18.116 v 13.002 h 7.406 v 4.03 h -4.672 c -7.148,0 -13.5,3.397 -17.54,8.661 H 5.512 V 54.268 H 0 V 63.695 65.967 88.3 90.572 100 h 5.512 v -9.427 h 13.104 c 4.04,5.264 10.391,8.661 17.54,8.661 h 27.3 c 7.148,0 13.5,-3.397 17.54,-8.661 H 94.488 V 100 H 100 V 90.573 88.3 65.967 63.695 54.268 H 94.488 Z M 63.69,48.265 h -8.573 v -6.677 h 2.333 v -3.585 h 6.239 V 48.265 Z M 35.922,38.002 h 6.239 v 3.585 h 2.333 v 6.677 h -8.572 z\"\n                    id=\"path1-7\" style=\"fill:#fb5700;fill-opacity:1\" />\n            </g>\n            <g id=\"light-9\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\">\n                <path fill=\"#ff5600\"\n                    d=\"m 51,58.3 c -0.428,0 -2.072,0 -2.5,0 -3.452,0 -6.25,8.432 -6.25,18.833 0,10.401 2.798,18.833 6.25,18.833 0.428,0 2.072,0 2.5,0 3.452,0 6.25,-8.432 6.25,-18.833 C 57.25,66.732 54.452,58.3 51,58.3 Z\"\n                    id=\"path2-2\" />\n                <polygon fill=\"#ff5600\"\n                    points=\"35.922,48.265 35.922,38.002 33.422,38.002 33.422,51.004 66.19,51.004 66.19,38.002 63.69,38.002 63.69,48.265 \"\n                    id=\"polygon2\" />\n            </g>\n            <g id=\"dark-0\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\"\n                style=\"fill:#3700cd;fill-opacity:1\">\n                <rect fill=\"#8a3400\" x=\"13\" y=\"33\" width=\"2.306\" height=\"3.5\" id=\"rect2\"\n                    style=\"fill:#3700cd;fill-opacity:1\" />\n                <rect fill=\"#8a3400\" x=\"84.306\" y=\"33\" width=\"2.194\" height=\"3.5\" id=\"rect3\"\n                    style=\"fill:#3700cd;fill-opacity:1\" />\n                <path fill=\"#8a3400\"\n                    d=\"M 15.306,7.048 H 13.89 c -1.833,0 -3.334,1.5 -3.334,3.333 V 27.79 c 0,1.833 1.5,3.334 3.334,3.334 h 1.416 z\"\n                    id=\"path3-2\" style=\"fill:#3700cd;fill-opacity:1\" />\n                <path fill=\"#8a3400\"\n                    d=\"m 85.722,7.048 h -1.416 v 24.076 h 1.416 c 1.833,0 3.334,-1.5 3.334,-3.334 V 10.381 c 0,-1.833 -1.501,-3.333 -3.334,-3.333 z\"\n                    id=\"path4\" style=\"fill:#3700cd;fill-opacity:1\" />\n                <rect x=\"13\" y=\"1.75\" fill=\"#8a3400\" width=\"2.306\" height=\"3.5\" id=\"rect4\"\n                    style=\"fill:#3700cd;fill-opacity:1\" />\n                <rect x=\"84.306\" y=\"1.75\" fill=\"#8a3400\" width=\"2.194\" height=\"3.5\" id=\"rect5\"\n                    style=\"fill:#3700cd;fill-opacity:1\" />\n            </g>\n            <g id=\"linear-3\" transform=\"matrix(0.3181153,0,0,0.24277307,138.89975,137.15491)\">\n                <linearGradient class=\"linear\" id=\"linearGradient17\" gradientUnits=\"userSpaceOnUse\" x1=\"23.924\"\n                    y1=\"95.863899\" x2=\"23.924\" y2=\"58.4035\">\n\n\n                    <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop16\" />\n                    <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop17\" />\n                </linearGradient>\n                <path class=\"linear\" fill=\"url(#SVGID_1_valve)\"\n                    d=\"m 42.25,77.134 c 0,-9.738 2.453,-17.748 5.598,-18.73 -5.426,0.547 -10.164,3.401 -13.239,7.564 H 0 V 88.3 h 34.609 c 3.075,4.162 7.813,7.016 13.239,7.564 -3.145,-0.983 -5.598,-8.992 -5.598,-18.73 z\"\n                    id=\"path6\" style=\"fill:url(#SVGID_1_valve)\" />\n                <linearGradient class=\"linear\" id=\"linearGradient19\" gradientUnits=\"userSpaceOnUse\" x1=\"75.825996\"\n                    y1=\"95.863899\" x2=\"75.825996\" y2=\"58.4035\">\n\n\n                    <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop18\" />\n                    <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop19\" />\n                </linearGradient>\n                <path class=\"linear\" fill=\"url(#SVGID_2_valve)\"\n                    d=\"m 64.891,65.967 c -3.075,-4.162 -7.813,-7.016 -13.239,-7.564 3.145,0.983 5.598,8.992 5.598,18.73 0,9.738 -2.453,17.748 -5.598,18.73 5.426,-0.547 10.164,-3.401 13.239,-7.564 H 100 V 65.967 Z\"\n                    id=\"path8\" style=\"fill:url(#SVGID_2_valve)\" />\n                <linearGradient class=\"linear\" id=\"linearGradient21\" gradientUnits=\"userSpaceOnUse\" x1=\"42.25\"\n                    y1=\"77.133698\" x2=\"54.75\" y2=\"77.133698\">\n\n\n                    <stop offset=\"0\" stop-color=\"#ff5600\" id=\"stop20\" />\n                    <stop offset=\"1\" stop-color=\"#1a0c00\" id=\"stop21\" />\n                </linearGradient>\n                <ellipse class=\"linear\" fill=\"url(#SVGID_3_valve)\" cx=\"48.5\" cy=\"77.134003\" rx=\"6.25\" ry=\"18.833\"\n                    id=\"ellipse10\" style=\"fill:url(#SVGID_3_valve)\" />\n            </g>\n        </g>\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.0876882;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect838\" width=\"32.10429\" height=\"16.893209\" x=\"182.06746\" y=\"125.09217\" ry=\"0.72612172\" />\n        <rect x=\"183.14116\" y=\"132.43747\"\n            style=\"fill:#20a040;stroke:#000000;stroke-width:0.0988302;stroke-miterlimit:4;stroke-dasharray:none\"\n            id=\"PIT_2001_BACK\" width=\"29.901171\" height=\"8.9342775\" ry=\"1.5642198\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"188.4615\" y=\"129.59193\"\n            id=\"e3_texte\" transform=\"scale(0.99223329,1.0078275)\">PIT_2001</text>\n        <rect x=\"184.38588\" y=\"133.90009\" style=\"fill:#000000;stroke:#000000;stroke-width:0.351923px\" id=\"PB_PIT_2001\"\n            width=\"27.1689\" height=\"6.0029826\" ry=\"1.774224\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"187.46359\" y=\"137.78943\"\n            id=\"PIT_2001_PV\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.0882461;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect25\" width=\"31.911753\" height=\"17.212103\" x=\"146.0816\" y=\"124.87519\" ry=\"0.73982877\" />\n        <rect x=\"147.15503\" y=\"132.22018\"\n            style=\"fill:#20a040;stroke:#000000;stroke-width:0.0988302;stroke-miterlimit:4;stroke-dasharray:none\"\n            id=\"TIT_2001_BACK\" width=\"29.900999\" height=\"8.9342775\" ry=\"1.5642198\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"151.18184\" y=\"129.41591\"\n            id=\"text27\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">TIT_2001</text>\n        <rect x=\"148.57204\" y=\"133.56424\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334291px\" id=\"PB_TIT_2001\"\n            width=\"27.026897\" height=\"6.0037985\" ry=\"1.6093168\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"151.48633\" y=\"137.04877\"\n            id=\"TIT_2001_PV\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.37;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect25-6\" width=\"57.387684\" height=\"35.357349\" x=\"70.428017\" y=\"113.19924\" ry=\"1.5197669\" />\n        <rect x=\"95.395157\" y=\"122.26904\"\n            style=\"fill:#20a040;stroke:#000000;stroke-width:0.0993539;stroke-miterlimit:4;stroke-dasharray:none\"\n            id=\"FIT_2001_FLOW_BACK\" width=\"30.220694\" height=\"8.933754\" ry=\"1.5641282\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"88.953773\" y=\"117.70494\"\n            id=\"text27-2\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">UIT_2001</text>\n        <rect x=\"96.482109\" y=\"123.40913\" style=\"fill:#000000;stroke:#000000;stroke-width:0.346362px\" id=\"PB_FIT_2001\"\n            width=\"28.052216\" height=\"6.5550799\" ry=\"1.6644852\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"98.585732\" y=\"127.69966\"\n            id=\"UIT_2001_FLOW\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect x=\"96.562965\" y=\"131.82391\" style=\"fill:#000000;stroke:#000000;stroke-width:0.334892px\" id=\"rect29\"\n            width=\"27.851984\" height=\"6.1721406\" ry=\"1.5672482\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"99.128487\" y=\"135.52972\"\n            id=\"UIT_2001_DENS\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect x=\"96.19445\" y=\"138.58199\" style=\"fill:#000000;stroke:#000000;stroke-width:0.336598px\" id=\"rect30\"\n            width=\"28.144466\" height=\"6.170434\" ry=\"1.5668147\" /><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;stroke-width:0.266654\" x=\"98.918953\" y=\"141.90445\"\n            id=\"UIT_2001_TBATCH\" transform=\"scale(0.99223329,1.0078275)\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"83.019676\" y=\"127.73837\"\n            id=\"text32\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Flujo</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"73.089027\" y=\"135.56105\"\n            id=\"text33\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Densidad</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"80.054741\" y=\"142.12895\"\n            id=\"text34\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Bache</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"76.437286\" y=\"77.234398\"\n            id=\"text36\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\" />\n        <rect\n            style=\"opacity:0.98;fill:#969696;fill-opacity:1;stroke:#050509;stroke-width:0.355549;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect36\" width=\"123.94976\" height=\"71.935417\" x=\"117.73807\" y=\"18.500645\" ry=\"3.0920043\" /><text\n            style=\"font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:6.12971px;font-family:C059;-inkscape-font-specification:'C059, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;fill:#000000;stroke-width:0.306484\"\n            x=\"129.58002\" y=\"30.807407\" id=\"text37\" transform=\"scale(1.035199,0.96599784)\" inkscape:label=\"LABEL\">DATOS\n            DEL BATCH</text><text style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\"\n            x=\"123.88683\" y=\"35.862377\" id=\"text38\" transform=\"scale(0.99223329,1.0078275)\"\n            inkscape:label=\"LABEL\">TIQUETE No.</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"135.64767\" y=\"58.419476\"\n            id=\"text40\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">FECHA:</text>\n        <g id=\"PB_START\" transform=\"translate(-6.3500006,4.7625002)\">\n            <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.12807;stroke-opacity:1\"\n                id=\"rect40\" width=\"21.756075\" height=\"6.2731276\" x=\"131.40912\" y=\"63.021721\" ry=\"0.99474156\"\n                rx=\"0.70873868\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\"\n                x=\"136.37537\" y=\"67.295044\" id=\"text41\" transform=\"scale(0.99223329,1.0078275)\"\n                inkscape:label=\"LABEL\">Iniciar</text>\n        </g>\n        <g id=\"PB_STOP\" transform=\"translate(-8.9958341,4.7625002)\">\n            <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.12807;stroke-opacity:1\"\n                id=\"rect41\" width=\"21.756075\" height=\"6.2731276\" x=\"158.15862\" y=\"63.244633\" ry=\"0.99474156\"\n                rx=\"0.70873868\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\"\n                x=\"163.33424\" y=\"67.516228\" id=\"text42\" transform=\"scale(0.99223329,1.0078275)\"\n                inkscape:label=\"LABEL\">Parar</text>\n        </g>\n        <g id=\"PB_CLEAR\" transform=\"translate(-11.112501,4.7625002)\">\n            <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.12807;stroke-opacity:1\"\n                id=\"rect42\" width=\"21.756075\" height=\"6.2731276\" x=\"184.79665\" y=\"63.356091\" ry=\"0.99474156\"\n                rx=\"0.70873868\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\"\n                x=\"190.29211\" y=\"67.544128\" id=\"text43\" transform=\"scale(0.99223329,1.0078275)\"\n                inkscape:label=\"LABEL\">Borrar</text>\n        </g>\n        <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.18908;stroke-opacity:1\"\n            id=\"rect44\" width=\"47.887272\" height=\"6.2121177\" x=\"158.85872\" y=\"31.405853\" ry=\"0.98506713\"\n            rx=\"1.5600039\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000080;stroke-width:0.266654\"\n            x=\"166.17841\" y=\"35.5047\" id=\"TIKET_N\" transform=\"scale(0.99223329,1.0078275)\">###.##</text>\n        <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.221802;stroke-opacity:1\"\n            id=\"rect45\" width=\"66.244827\" height=\"6.1793962\" x=\"157.48256\" y=\"53.483353\" ry=\"0.97987843\"\n            rx=\"2.1580303\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000080;stroke-width:0.266654\"\n            x=\"160.08493\" y=\"58.05772\" id=\"Date_Time\" transform=\"scale(0.99223329,1.0078275)\">DD-MM-AAAA HH:MM:SS</text>\n        <path id=\"path45\" style=\"fill:#0000ff;fill-opacity:1;stroke:#303130;stroke-width:0.201537;stroke-opacity:1\"\n            d=\"m 160.59544,142.51871 a 4.1227484,3.9335248 0 0 0 -4.12256,3.9335 4.1227484,3.9335248 0 0 0 2.35587,3.54978 v 2.47693 h 3.21985 v -2.35634 a 4.1227484,3.9335248 0 0 0 2.66985,-3.67037 4.1227484,3.9335248 0 0 0 -4.12301,-3.9335 z\" />\n        <ellipse style=\"fill:#4e802b;fill-opacity:1;stroke:#d6d6d6;stroke-width:0.3156;stroke-opacity:1\" id=\"path46\"\n            cx=\"160.54024\" cy=\"146.4985\" rx=\"2.8750091\" ry=\"2.779753\" />\n        <rect style=\"fill:#1c1c1d;fill-opacity:1;stroke:#303130;stroke-width:0.214313;stroke-opacity:1\" id=\"rect46\"\n            width=\"1.2072288\" height=\"1.3368448\" x=\"195.74265\" y=\"150.62567\" />\n        <path id=\"path47\" style=\"fill:#0000ff;fill-opacity:1;stroke:#303130;stroke-width:0.201537;stroke-opacity:1\"\n            d=\"m 198.39812,142.19087 a 4.1227484,3.9335248 0 0 0 -4.12256,3.9335 4.1227484,3.9335248 0 0 0 2.35587,3.54978 v 2.47693 h 3.21985 v -2.35634 a 4.1227484,3.9335248 0 0 0 2.66985,-3.67037 4.1227484,3.9335248 0 0 0 -4.12301,-3.9335 z\" />\n        <ellipse style=\"fill:#4e802b;fill-opacity:1;stroke:#d6d6d6;stroke-width:0.3156;stroke-opacity:1\" id=\"ellipse47\"\n            cx=\"198.34293\" cy=\"146.17065\" rx=\"2.8750091\" ry=\"2.779753\" />\n        <rect style=\"fill:#1c1c1d;fill-opacity:1;stroke:#303130;stroke-width:0.214313;stroke-opacity:1\" id=\"rect47\"\n            width=\"1.2072288\" height=\"1.3368448\" x=\"233.54533\" y=\"150.29782\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.327231;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect48\" width=\"30.056038\" height=\"6.4117637\" x=\"147.00948\" y=\"125.64333\" ry=\"0.81769329\"\n            rx=\"0.5445466\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.327231;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect49\" width=\"30.056038\" height=\"6.4117637\" x=\"182.89018\" y=\"125.87598\" ry=\"0.81769329\"\n            rx=\"0.5445466\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect50\" width=\"54.268116\" height=\"6.3030343\" x=\"71.94603\" y=\"114.26385\" ry=\"0.80382699\"\n            rx=\"0.98321402\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.2;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect51\" width=\"54.35508\" height=\"25.636318\" x=\"71.90255\" y=\"121.25523\" ry=\"1.278403\" rx=\"0.98478967\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.407838;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect54\" width=\"116.96667\" height=\"21.450598\" x=\"121.9847\" y=\"64.864021\" ry=\"2.7355986\" rx=\"2.1191683\" />\n        <rect\n            style=\"opacity:0.98;fill:none;fill-opacity:1;stroke:#050505;stroke-width:0.308941;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1\"\n            id=\"rect55\" width=\"116.61134\" height=\"42.170036\" x=\"121.43908\" y=\"21.254679\" ry=\"2.9276142\" rx=\"2.11273\" />\n        <text style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"123.88683\"\n            y=\"46.888531\" id=\"text55\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">PRODUCTO:</text>\n        <rect style=\"opacity:1;fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.18908;stroke-opacity:1\"\n            id=\"rect56\" width=\"47.887272\" height=\"6.2121177\" x=\"158.63591\" y=\"42.072674\" ry=\"0.98506713\"\n            rx=\"1.5600039\" /><text style=\"font-size:5.33309px;font-family:Arial;fill:#000080;stroke-width:0.266654\"\n            x=\"165.81352\" y=\"46.22683\" id=\"PRODUCTO\" transform=\"scale(0.99223329,1.0078275)\"\n            onclick=\"\">###.##</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"139.15619\" y=\"82.205193\"\n            id=\"text1\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">ESTADO DEL BACHE</text><text\n            style=\"font-size:5.33309px;font-family:Arial;fill:#00ffff;fill-opacity:1;stroke-width:0.266654\"\n            x=\"198.82224\" y=\"81.930382\" id=\"BATCH_STATUS\" transform=\"scale(0.99223329,1.0078275)\"\n            onclick=\"showModal()\">###.##</text>\n        <g id=\"GenerarTiquete\">\n            <rect style=\"fill:#cfcfd0;fill-opacity:1;stroke:#303130;stroke-width:0.164221;stroke-opacity:1\" id=\"rect6\"\n                width=\"35.979\" height=\"6.2369761\" x=\"197.76518\" y=\"68.136665\" ry=\"0.98900896\" rx=\"1.1720879\" /><text\n                style=\"font-size:5.33309px;font-family:Arial;fill:#000000;stroke-width:0.266654\" x=\"201.54755\"\n                y=\"72.186729\" id=\"text6\" transform=\"scale(0.99223329,1.0078275)\" inkscape:label=\"LABEL\">Generar\n                Rep</text>\n        </g><text style=\"font-size:2.41441px;font-family:Arial;fill:#ffeeaa;stroke-width:0.12072\" x=\"206.12617\"\n            y=\"113.25062\" id=\"text19\" transform=\"scale(0.76834912,1.3014917)\" inkscape:label=\"LABEL\">8888</text><text\n            style=\"font-size:2.41441px;font-family:Arial;fill:#ffeeaa;stroke-width:0.12072\" x=\"255.42261\" y=\"113.25062\"\n            id=\"text2\" transform=\"scale(0.76834912,1.3014917)\" inkscape:label=\"LABEL\">8888</text>\n    </g>\n</svg>",
        "clickableShapes": [
            {
                "targetId": "#TIKET_N",
                "action": "click",
                "payload": "Numero De Tikete",
                "payloadType": "str",
                "topic": "TIKET_N"
            },
            {
                "targetId": "#PB_START",
                "action": "click",
                "payload": "Iniciar",
                "payloadType": "str",
                "topic": "PB_START"
            },
            {
                "targetId": "#PB_STOP",
                "action": "click",
                "payload": "Parar",
                "payloadType": "str",
                "topic": "PB_STOP"
            },
            {
                "targetId": "#PB_CLEAR",
                "action": "click",
                "payload": "Borrar",
                "payloadType": "str",
                "topic": "PB_CLEAR"
            },
            {
                "targetId": "#GenerarTiquete",
                "action": "click",
                "payload": "GenerarTiquete",
                "payloadType": "str",
                "topic": "GenerarTiquete"
            },
            {
                "targetId": "#PRODUCTO",
                "action": "click",
                "payload": "butano",
                "payloadType": "str",
                "topic": "PRODUCTO"
            },
            {
                "targetId": "#PB_PIT_2001",
                "action": "click",
                "payload": "PB_PIT_2001",
                "payloadType": "str",
                "topic": "PB_PIT_2001"
            },
            {
                "targetId": "#PB_TIT_2001",
                "action": "click",
                "payload": "PB_TIT_2001",
                "payloadType": "str",
                "topic": "PB_TIT_2001"
            },
            {
                "targetId": "#PB_FIT_2001",
                "action": "click",
                "payload": "PB_FIT_2001",
                "payloadType": "str",
                "topic": "PB_FIT_2001"
            }
        ],
        "javascriptHandlers": [],
        "smilAnimations": [],
        "bindings": [
            {
                "selector": "#PIT_2001_PV",
                "bindSource": "payload.PIT_2001_PV",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#PIT_2001_BACK",
                "bindSource": "payload.PIT_2001_ALARM",
                "bindType": "style",
                "attribute": "fill"
            },
            {
                "selector": "#TIT_2001_PV",
                "bindSource": "payload.TIT_2001_PV",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#TIT_2001_BACK",
                "bindSource": "payload.TIT_2001_ALARM",
                "bindType": "style",
                "attribute": "fill"
            },
            {
                "selector": "#Date_Time",
                "bindSource": "payload.DATE_STRING",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#TIKET_N",
                "bindSource": "payload.TIKET_N",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#UIT_2001_FLOW",
                "bindSource": "payload.UIT_2001_FLOW",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#UIT_2001_DENS",
                "bindSource": "payload.UIT_2001_DENS",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#UIT_2001_TBATCH",
                "bindSource": "payload.UIT_2001_TBATCH",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#BATCH_STATUS",
                "bindSource": "payload.STATUS_BATCH",
                "bindType": "text",
                "attribute": ""
            },
            {
                "selector": "#BATCH_STATUS",
                "bindSource": "payload.STATUS_BATCH_COLOR",
                "bindType": "style",
                "attribute": "fill"
            }
        ],
        "showCoordinates": false,
        "autoFormatAfterEdit": false,
        "showBrowserErrors": false,
        "showBrowserEvents": false,
        "enableJsDebugging": false,
        "sendMsgWhenLoaded": false,
        "noClickWhenDblClick": false,
        "outputField": "payload",
        "editorUrl": "//drawsvg.org/drawsvg.html",
        "directory": "",
        "panning": "disabled",
        "zooming": "disabled",
        "panOnlyWhenZoomed": false,
        "doubleClickZoomEnabled": false,
        "mouseWheelZoomEnabled": false,
        "dblClickZoomPercentage": 150,
        "cssString": "div.ui-svg svg{\n    color: var(--nr-dashboard-widgetColor);\n    fill: currentColor !important;\n}\ndiv.ui-svg path {\n    fill: inherit;\n}",
        "name": "",
        "x": 720,
        "y": 320,
        "wires": [
            [
                "89cf21ba1acbaf97"
            ]
        ]
    },
    {
        "id": "d6e1c0a82dd7fc05",
        "type": "inject",
        "z": "619addbf2da107aa",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 360,
        "y": 320,
        "wires": [
            [
                "e4262efbb96ecdbd"
            ]
        ]
    },
    {
        "id": "e4262efbb96ecdbd",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "Update Display",
        "func": "let pit_1001 = global.get(\"PIT_2001\");\nlet tit_1001 = global.get(\"TIT_2001\");\nlet tiket_number = global.get(\"TIKET_N\") || 0;\nlet butano = global.get(\"BUTANO\");\nlet propano = global.get(\"PROPANO\");\nlet producto_seleccionado = flow.get(\"producto_seleccionado\") || \"butano\";\n\nvar fecha = new Date();\n\n// Formato: DD-MM-YYYY HH:MM:SS\nvar year = fecha.getFullYear();\nvar mes = String(fecha.getMonth() + 1).padStart(2, '0');\nvar dia = String(fecha.getDate()).padStart(2, '0');\nvar horas = String(fecha.getHours()).padStart(2, '0');\nvar minutos = String(fecha.getMinutes()).padStart(2, '0');\nvar segundos = String(fecha.getSeconds()).padStart(2, '0');\n\nlet date_string = dia + \"-\" + mes + \"-\" + year + \" \" + horas + \":\" + minutos + \":\" + segundos;\n\n// Seleccionar los datos según el producto\n\nlet status_color=\"#aa4400\";\n\nlet status_batch=global.get(\"STATUS_BATCH\") || \"NONE\";\n\nif(status_batch===\"ACTIVO\")\n{\n    status_color=\"#00ff00\";\n}\nelse if(status_batch===\"PAUSADO\")\n{\n    status_color=\"#ffd42a\";\n}\nelse if(status_batch===\"LISTO\")\n{\n    status_color=\"#00ffff\"; \n}\n\nlet datos_producto = {};\n\nif (producto_seleccionado === \"butano\") {\n    datos_producto = butano;\n} else if (producto_seleccionado === \"propano\") {\n    datos_producto = propano;\n} else if (producto_seleccionado === \"ambos\") {\n    // Puedes decidir mostrar butano, propano o ambos\n    datos_producto = butano; // o propano, según prefieras\n}\n\nmsg.topic = \"databind\";\nmsg.payload = {\n    \"PIT_2001_PV\": pit_1001.PV.toFixed(1) + \" PSI\",\n    \"PIT_2001_ALARM\": pit_1001.ALARM,\n\n    \"TIT_2001_PV\": tit_1001.PV.toFixed(1) + \" °F\",\n    \"TIT_2001_ALARM\": tit_1001.ALARM,\n\n    \"DATE_STRING\": date_string,\n    \"TIKET_N\": tiket_number,\n    \"PRODUCTO\": producto_seleccionado.toUpperCase(),\n\n    \"UIT_2001_FLOW\": datos_producto.flujo,\n    \"UIT_2001_DENS\": datos_producto.densidad,\n    \"UIT_2001_TBATCH\": datos_producto.batch,\n    \"STATUS_BATCH\" : status_batch,\n    \"STATUS_BATCH_COLOR\" : status_color\n};\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 320,
        "wires": [
            [
                "12771eacfe1bc3b8"
            ]
        ]
    },
    {
        "id": "bbd7b1def44d4696",
        "type": "inject",
        "z": "619addbf2da107aa",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 430,
        "y": 400,
        "wires": [
            [
                "37f13c203521c7b1"
            ]
        ]
    },
    {
        "id": "833023ecbab1c9c0",
        "type": "debug",
        "z": "619addbf2da107aa",
        "name": "debug 9",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1960,
        "y": 440,
        "wires": []
    },
    {
        "id": "37f13c203521c7b1",
        "type": "ui_template",
        "z": "619addbf2da107aa",
        "group": "2b6a27989e458e3b",
        "name": "",
        "order": 2,
        "width": 17,
        "height": 1,
        "format": "<head>\n    <title>Grafana Dashboard en Node-RED</title>\n    <style>\n        body,\n        html {\n            margin: 0;\n            padding: 0;\n            height: 100%;\n            overflow: hidden;\n        }\n\n        iframe {\n            width: 100%;\n            height: 100%;\n            border: none;\n        }\n    </style>\n</head>\n\n<body>\n    <iframe src=\"http://192.168.0.22:3000/d/fdyejdpdouqyob/pit-1001?orgId=1&from=now-6h&to=now\" frameborder=\"0\"\n        allowfullscreen></iframe>\n</body>",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 600,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "dc1c3ff01ad27c44",
        "type": "ui_button",
        "z": "619addbf2da107aa",
        "name": "",
        "group": "2b6a27989e458e3b",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Cerrar",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"tab\":\"Main\"}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 390,
        "y": 460,
        "wires": [
            [
                "e51b3e5685e51b2e"
            ]
        ]
    },
    {
        "id": "e51b3e5685e51b2e",
        "type": "ui_ui_control",
        "z": "619addbf2da107aa",
        "name": "",
        "events": "all",
        "x": 580,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "53c8730fc2506e88",
        "type": "ui_button",
        "z": "619addbf2da107aa",
        "name": "",
        "group": "f5490ef343d6cb98",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "GasDisplay",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"tab\":\"reciveCleaner\"}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 370,
        "y": 500,
        "wires": [
            [
                "e51b3e5685e51b2e"
            ]
        ]
    },
    {
        "id": "06c073855efc00ad",
        "type": "ui_button",
        "z": "619addbf2da107aa",
        "name": "",
        "group": "f5490ef343d6cb98",
        "order": 3,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Alarmas",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"tab\":\"Alarmas\"}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 380,
        "y": 540,
        "wires": [
            [
                "e51b3e5685e51b2e"
            ]
        ]
    },
    {
        "id": "89cf21ba1acbaf97",
        "type": "switch",
        "z": "619addbf2da107aa",
        "name": "SelectEvent",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "TIKET_N",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_START",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_STOP",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_CLEAR",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "GenerarTiquete",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PRODUCTO",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_PIT_2001",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_TIT_2001",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "PB_FIT_2001",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 9,
        "x": 890,
        "y": 320,
        "wires": [
            [
                "72db325840e00c4d"
            ],
            [
                "668e96e992844b25"
            ],
            [
                "3d2e13eab5990489"
            ],
            [
                "1779d316384bdd4c"
            ],
            [
                "73ed113b1482079c"
            ],
            [
                "8ddeb615c2d02dcd"
            ],
            [
                "5f2f44f7618ef7f4"
            ],
            [
                "2c7dff1a7105d11e"
            ],
            [
                "537f53ef822ccf6f"
            ]
        ]
    },
    {
        "id": "72db325840e00c4d",
        "type": "ui_toast",
        "z": "619addbf2da107aa",
        "position": "prompt",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "Tiquete",
        "name": "Tiket Number",
        "x": 1100,
        "y": 160,
        "wires": [
            [
                "5328fd5f96947bd2"
            ]
        ]
    },
    {
        "id": "5328fd5f96947bd2",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "SetTiket",
        "func": "\nif(msg.payload!=\"Cansel\")\n{\n    let tiket_number=parseInt(msg.payload);\n\n    if(tiket_number>=1 && tiket_number<=100000){\n        global.set(\"TIKET_N\",tiket_number);\n    }\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "668e96e992844b25",
        "type": "ui_toast",
        "z": "619addbf2da107aa",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "Desea Iniciar Bache?",
        "name": "Start",
        "x": 1130,
        "y": 200,
        "wires": [
            [
                "685ecf0080349123",
                "bc13297a3ab23f0a"
            ]
        ]
    },
    {
        "id": "685ecf0080349123",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "SetsTART",
        "func": "\nif(msg.payload!=\"Cansel\")\n{\n   \n\n    \n        global.set(\"START_BATCH\",true);\n    \n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "3d2e13eab5990489",
        "type": "ui_toast",
        "z": "619addbf2da107aa",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "Desea Terminar el Bache?",
        "name": "Stop",
        "x": 1130,
        "y": 240,
        "wires": [
            [
                "9d8d6664f2691042",
                "bc13297a3ab23f0a"
            ]
        ]
    },
    {
        "id": "9d8d6664f2691042",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "SetSTOP",
        "func": "\nif(msg.payload!=\"Cansel\")\n{\n    global.set(\"STOP_BATCH\",true);\n    \n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1280,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "1779d316384bdd4c",
        "type": "ui_toast",
        "z": "619addbf2da107aa",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "Desea Borrar Totalizadores?",
        "name": "Clear",
        "x": 1130,
        "y": 280,
        "wires": [
            [
                "bc13297a3ab23f0a",
                "384441782bb7e83d"
            ]
        ]
    },
    {
        "id": "384441782bb7e83d",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "SetCLEAR",
        "func": "let status_batch=global.get(\"STATUS_BATCH\");\n\n\nif(msg.payload!=\"Cansel\" && status_batch===\"PAUSADO\")\n{\n    global.set(\"CLEAR_BATCH\",true);\n    msg.topic=\"OK\";\n}\nelse\n{\n    msg.topic=null;\n    msg.payload = \"⚠️ El batch debe estar PAUSADO antes de borrar los totalizadore\";\n}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1290,
        "y": 280,
        "wires": [
            [
                "bb402655e34c6c09"
            ]
        ]
    },
    {
        "id": "bc13297a3ab23f0a",
        "type": "debug",
        "z": "619addbf2da107aa",
        "name": "debug 2",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1440,
        "y": 220,
        "wires": []
    },
    {
        "id": "690a94335ba63084",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "SetProduct",
        "func": "// Cuando el usuario selecciona un producto en el popup\nvar producto = msg.payload; // \"butano\", \"propano\", o \"ambos\"\n\n// Guardar en flow context\nflow.set(\"producto_seleccionado\", producto);\n\n// Opcional: enviar mensaje de confirmación\nmsg.payload = {\n    producto: producto,\n    mensaje: \"Producto seleccionado: \" + producto.toUpperCase()\n};\n\nnode.status({fill: \"green\", shape: \"dot\", text: producto.toUpperCase()});\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1470,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "8819b49243222e1b",
        "type": "ui_template",
        "z": "619addbf2da107aa",
        "group": "f5490ef343d6cb98",
        "name": "Product Popup ",
        "order": 5,
        "width": 2,
        "height": 1,
        "format": "<div id=\"modal-overlay\" class=\"modal-overlay\" ng-click=\"closeOnOverlay($event)\">\n    <div class=\"modal-box\" ng-click=\"$event.stopPropagation()\">\n        <div class=\"modal-header\">Seleccionar Producto</div>\n\n        <label class=\"radio-option\">\n            <input type=\"radio\" ng-model=\"selectedProduct\" value=\"butano\">\n            <span class=\"radio-label\">🔵 BUTANO</span>\n        </label>\n\n        <label class=\"radio-option\">\n            <input type=\"radio\" ng-model=\"selectedProduct\" value=\"propano\">\n            <span class=\"radio-label\">🟠 PROPANO</span>\n        </label>\n\n        <label class=\"radio-option\">\n            <input type=\"radio\" ng-model=\"selectedProduct\" value=\"ambos\">\n            <span class=\"radio-label\">🟣 AMBOS</span>\n        </label>\n\n        <div class=\"btn-group\">\n            <button class=\"btn-confirm\" ng-click=\"confirmSelection()\">Confirmar</button>\n            <button class=\"btn-cancel\" ng-click=\"hideModal()\">Cancelar</button>\n        </div>\n    </div>\n</div>\n\n<style>\n    .modal-overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.5);\n        z-index: 99999;\n        justify-content: center;\n        align-items: center;\n    }\n\n    .modal-overlay.show {\n        display: flex !important;\n    }\n\n    .modal-box {\n        background: white;\n        padding: 25px;\n        border-radius: 8px;\n        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);\n        min-width: 320px;\n        max-width: 400px;\n    }\n\n    .modal-header {\n        font-size: 18px;\n        font-weight: bold;\n        margin-bottom: 20px;\n        color: #2c3e50;\n        border-bottom: 2px solid #3498db;\n        padding-bottom: 10px;\n    }\n\n    .radio-option {\n        padding: 12px 15px;\n        margin: 8px 0;\n        border: 2px solid #ddd;\n        border-radius: 6px;\n        cursor: pointer;\n        transition: all 0.2s;\n        display: flex;\n        align-items: center;\n        background: #f8f9fa;\n        \n    }\n\n    .radio-option:hover {\n        border-color: #3498db;\n        background: #e8f4f8;\n    }\n\n    .radio-option input[type=\"radio\"] {\n        margin-right: 12px;\n        width: 18px;\n        height: 18px;\n        cursor: pointer;\n        accent-color: #3498db;\n    }\n\n    .radio-label {\n        font-size: 15px;\n        font-weight: 500;\n        cursor: pointer;\n        user-select: none;\n        color: #000000;\n    }\n\n    .btn-group {\n        display: flex;\n        gap: 10px;\n        margin-top: 20px;\n    }\n\n    .btn-confirm {\n        flex: 1;\n        padding: 12px;\n        background: #27ae60;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 14px;\n        font-weight: bold;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n\n    .btn-confirm:hover {\n        background: #229954;\n    }\n\n    .btn-cancel {\n        flex: 1;\n        padding: 12px;\n        background: #7f8c8d;\n        color: white;\n        border: none;\n        border-radius: 6px;\n        font-size: 14px;\n        font-weight: bold;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n\n    .btn-cancel:hover {\n        background: #95a5a6;\n    }\n</style>\n\n<script>\n    (function(scope) {\n       // Escuchar mensajes de Node-RED\n    scope.$watch('msg', function(msg) {\n        if (msg) {\n            if (msg.topic === 'select_product') {\n                showModal();\n            } else if (msg.topic === 'error_tiquete') {\n                mostrarError(msg.payload.mensaje);\n            }\n        }\n    });\n    \n    // Inicializar con butano por defecto\n    scope.selectedProduct = 'butano';\n    \n    // Exponer funciones globalmente para que SVG pueda accederlas\n    window.showModal = function() {\n        console.log('Abriendo modal desde SVG');\n        var modal = document.getElementById('modal-overlay');\n        if (modal) {\n            modal.classList.add('show');\n            modal.style.display = 'flex';\n        }\n    };\n    \n    scope.hideModal = function() {\n        var modal = document.getElementById('modal-overlay');\n        if (modal) {\n            modal.classList.remove('show');\n            modal.style.display = 'none';\n        }\n    };\n    \n    scope.closeOnOverlay = function(event) {\n        if (event.target.id === 'modal-overlay') {\n            scope.hideModal();\n        }\n    };\n    \n    scope.confirmSelection = function() {\n        console.log('Producto seleccionado:', scope.selectedProduct);\n        \n        // Actualizar campo PRODUCTO en SVG\n        var productoField = document.getElementById('PRODUCTO');\n        if (productoField) {\n            productoField.textContent = scope.selectedProduct.toUpperCase();\n        }\n        \n        // Enviar a Node-RED\n        scope.send({\n            payload: scope.selectedProduct,\n            topic: 'producto_seleccionado'\n        });\n        \n        scope.hideModal();\n    };\n    \n    // Cerrar con ESC\n    document.addEventListener('keydown', function(event) {\n        if (event.key === 'Escape') {\n            scope.hideModal();\n        }\n    });\n    \n    // Exponer también en window para compatibilidad\n    window.hideModal = scope.hideModal;\n    \n})(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1300,
        "y": 360,
        "wires": [
            [
                "690a94335ba63084"
            ]
        ]
    },
    {
        "id": "73ed113b1482079c",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "Create Tiket",
        "func": "let status_batch=global.get(\"STATUS_BATCH\");\n\nif(status_batch===\"PAUSADO\")\n{\n    global.set(\"IS_REPORT\",true);\n    msg.topic=\"OK\";\n}\nelse{\n    msg.topic=null;\n    msg.payload = \"⚠️ El batch debe estar PAUSADO antes de Generar el tiquete\";\n\n}\n\n\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1110,
        "y": 320,
        "wires": [
            [
                "f6f66db1c4cf61c6"
            ]
        ]
    },
    {
        "id": "f6f66db1c4cf61c6",
        "type": "switch",
        "z": "619addbf2da107aa",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1290,
        "y": 320,
        "wires": [
            [],
            [
                "c61211dcc80df7fa"
            ]
        ]
    },
    {
        "id": "c61211dcc80df7fa",
        "type": "ui_toast",
        "z": "619addbf2da107aa",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1690,
        "y": 300,
        "wires": []
    },
    {
        "id": "bb402655e34c6c09",
        "type": "switch",
        "z": "619addbf2da107aa",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1450,
        "y": 280,
        "wires": [
            [],
            [
                "c61211dcc80df7fa"
            ]
        ]
    },
    {
        "id": "8ddeb615c2d02dcd",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "function 5",
        "func": "msg.topic='select_product';\n//msg.payload=\"showModal()\";\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 360,
        "wires": [
            [
                "8819b49243222e1b"
            ]
        ]
    },
    {
        "id": "53e166a9b03ef43c",
        "type": "ui_template",
        "z": "619addbf2da107aa",
        "group": "f5490ef343d6cb98",
        "name": "AnalogSET",
        "order": 7,
        "width": 1,
        "height": 1,
        "format": "<style>\n    .alarm-modal-overlay {\n        display: none;\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        background: rgba(0, 0, 0, 0.7);\n        z-index: 9999;\n        justify-content: center;\n        align-items: center;\n    }\n\n    .alarm-modal-overlay.show {\n        display: flex !important;\n    }\n\n    .alarm-modal {\n        background: #2d2d2d;\n        border-radius: 12px;\n        width: 380px;\n        max-width: 95%;\n        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n        overflow: hidden;\n        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    }\n\n    .alarm-modal-header {\n        background: linear-gradient(135deg, #1e88e5, #1565c0);\n        color: white;\n        padding: 15px 20px;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n    }\n\n    .alarm-modal-header h3 {\n        margin: 0;\n        font-size: 16px;\n        font-weight: 600;\n    }\n\n    .alarm-modal-close {\n        background: rgba(255, 255, 255, 0.2);\n        border: none;\n        color: white;\n        width: 28px;\n        height: 28px;\n        border-radius: 50%;\n        cursor: pointer;\n        font-size: 18px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        transition: background 0.2s;\n    }\n\n    .alarm-modal-close:hover {\n        background: rgba(255, 255, 255, 0.3);\n    }\n\n    .alarm-modal-body {\n        padding: 20px;\n    }\n\n    .tag-info {\n        background: #383838;\n        border-radius: 8px;\n        padding: 12px;\n        margin-bottom: 15px;\n        text-align: center;\n    }\n\n    .tag-name {\n        font-size: 18px;\n        font-weight: bold;\n        color: #4fc3f7;\n    }\n\n    .tag-desc {\n        font-size: 12px;\n        color: #aaa;\n        margin-top: 4px;\n    }\n\n    .pv-display {\n        background: #1a1a1a;\n        border-radius: 8px;\n        padding: 15px;\n        margin-bottom: 15px;\n        text-align: center;\n        border: 2px solid #333;\n    }\n\n    .pv-value {\n        font-size: 32px;\n        font-weight: bold;\n        color: #00e676;\n    }\n\n    .pv-unit {\n        font-size: 14px;\n        color: #888;\n        margin-left: 5px;\n    }\n\n    .alarm-section {\n        margin-bottom: 10px;\n    }\n\n    .alarm-row {\n        display: flex;\n        align-items: center;\n        padding: 8px 10px;\n        background: #383838;\n        border-radius: 6px;\n        margin-bottom: 6px;\n        transition: background 0.2s;\n    }\n\n    .alarm-row:hover {\n        background: #404040;\n    }\n\n    .alarm-row.hh {\n        border-left: 4px solid #f44336;\n    }\n\n    .alarm-row.h {\n        border-left: 4px solid #ff9800;\n    }\n\n    .alarm-row.l {\n        border-left: 4px solid #2196f3;\n    }\n\n    .alarm-row.ll {\n        border-left: 4px solid #9c27b0;\n    }\n\n    .alarm-enable {\n        margin-right: 10px;\n    }\n\n    .alarm-enable input[type=\"checkbox\"] {\n        width: 18px;\n        height: 18px;\n        cursor: pointer;\n        accent-color: #4caf50;\n    }\n\n    .alarm-label {\n        flex: 1;\n        font-size: 13px;\n        font-weight: 500;\n        color: #ddd;\n    }\n\n    .alarm-input {\n        width: 80px;\n        padding: 6px 8px;\n        border: 1px solid #555;\n        border-radius: 4px;\n        background: #2a2a2a;\n        color: #fff;\n        font-size: 13px;\n        text-align: right;\n    }\n\n    .alarm-input:focus {\n        outline: none;\n        border-color: #1e88e5;\n        box-shadow: 0 0 0 2px rgba(30, 136, 229, 0.3);\n    }\n\n    .alarm-input:disabled {\n        opacity: 0.4;\n        cursor: not-allowed;\n    }\n\n    .range-section {\n        background: #383838;\n        border-radius: 6px;\n        padding: 10px;\n        margin-bottom: 15px;\n    }\n\n    .range-title {\n        font-size: 11px;\n        color: #888;\n        margin-bottom: 8px;\n        text-transform: uppercase;\n    }\n\n    .range-row {\n        display: flex;\n        gap: 10px;\n    }\n\n    .range-item {\n        flex: 1;\n        display: flex;\n        flex-direction: column;\n    }\n\n    .range-label {\n        font-size: 11px;\n        color: #aaa;\n        margin-bottom: 4px;\n    }\n\n    .range-input {\n        padding: 6px 8px;\n        border: 1px solid #555;\n        border-radius: 4px;\n        background: #2a2a2a;\n        color: #fff;\n        font-size: 12px;\n        text-align: center;\n    }\n\n    .range-input:focus {\n        outline: none;\n        border-color: #1e88e5;\n    }\n\n    .alarm-modal-footer {\n        display: flex;\n        gap: 10px;\n        padding: 0 20px 20px;\n    }\n\n    .btn {\n        flex: 1;\n        padding: 10px 15px;\n        border: none;\n        border-radius: 6px;\n        font-size: 13px;\n        font-weight: 600;\n        cursor: pointer;\n        transition: all 0.2s;\n    }\n\n    .btn-cancel {\n        background: #555;\n        color: #fff;\n    }\n\n    .btn-cancel:hover {\n        background: #666;\n    }\n\n    .btn-save {\n        background: linear-gradient(135deg, #4caf50, #388e3c);\n        color: white;\n    }\n\n    .btn-save:hover {\n        background: linear-gradient(135deg, #66bb6a, #43a047);\n        transform: translateY(-1px);\n    }\n</style>\n\n<div id=\"alarmConfigModal\" class=\"alarm-modal-overlay\">\n    <div class=\"alarm-modal\">\n        <div class=\"alarm-modal-header\">\n            <h3 id=\"modalTitle\">Configuración de Alarmas</h3>\n            <button class=\"alarm-modal-close\" onclick=\"closeAlarmModal()\">×</button>\n        </div>\n\n        <div class=\"alarm-modal-body\">\n            <div class=\"tag-info\">\n                <div class=\"tag-name\" id=\"displayTagName\">PIT_2001</div>\n                <div class=\"tag-desc\" id=\"displayTagDesc\">Presion de Descarga</div>\n            </div>\n\n            <div class=\"pv-display\">\n                <span class=\"pv-value\" id=\"displayPV\">0.0</span>\n                <span class=\"pv-unit\" id=\"displayUnit\">PSI</span>\n            </div>\n\n            <div class=\"alarm-section\">\n                <div class=\"alarm-row hh\">\n                    <div class=\"alarm-enable\">\n                        <input type=\"checkbox\" id=\"enableHH\" onchange=\"toggleAlarmInput('HH')\">\n                    </div>\n                    <div class=\"alarm-label\">HH - Muy Alto</div>\n                    <input type=\"number\" class=\"alarm-input\" id=\"inputHH\" step=\"0.1\">\n                </div>\n\n                <div class=\"alarm-row h\">\n                    <div class=\"alarm-enable\">\n                        <input type=\"checkbox\" id=\"enableH\" onchange=\"toggleAlarmInput('H')\">\n                    </div>\n                    <div class=\"alarm-label\">H - Alto</div>\n                    <input type=\"number\" class=\"alarm-input\" id=\"inputH\" step=\"0.1\">\n                </div>\n\n                <div class=\"alarm-row l\">\n                    <div class=\"alarm-enable\">\n                        <input type=\"checkbox\" id=\"enableL\" onchange=\"toggleAlarmInput('L')\">\n                    </div>\n                    <div class=\"alarm-label\">L - Bajo</div>\n                    <input type=\"number\" class=\"alarm-input\" id=\"inputL\" step=\"0.1\">\n                </div>\n\n                <div class=\"alarm-row ll\">\n                    <div class=\"alarm-enable\">\n                        <input type=\"checkbox\" id=\"enableLL\" onchange=\"toggleAlarmInput('LL')\">\n                    </div>\n                    <div class=\"alarm-label\">LL - Muy Bajo</div>\n                    <input type=\"number\" class=\"alarm-input\" id=\"inputLL\" step=\"0.1\">\n                </div>\n            </div>\n\n            <div class=\"range-section\">\n                <div class=\"range-title\">Rango del Instrumento</div>\n                <div class=\"range-row\">\n                    <div class=\"range-item\">\n                        <span class=\"range-label\">Mínimo</span>\n                        <input type=\"number\" class=\"range-input\" id=\"inputMin\" step=\"0.1\">\n                    </div>\n                    <div class=\"range-item\">\n                        <span class=\"range-label\">Máximo</span>\n                        <input type=\"number\" class=\"range-input\" id=\"inputMax\" step=\"0.1\">\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"alarm-modal-footer\">\n            <button class=\"btn btn-cancel\" onclick=\"closeAlarmModal()\">Cancelar</button>\n            <button class=\"btn btn-save\" onclick=\"saveAlarmConfig()\">Guardar</button>\n        </div>\n    </div>\n</div>\n\n<script>\n    var currentTagData = null;\n    var angularScope = null;  // Referencia global al scope\n    \n    // Función para abrir el popup con los datos del tag\n    function openAlarmModal(tagData) {\n        currentTagData = tagData;\n        \n        // Actualizar información del tag\n        document.getElementById('displayTagName').textContent = tagData.TagName || 'N/A';\n        document.getElementById('displayTagDesc').textContent = tagData.Descripcion || '';\n        document.getElementById('displayPV').textContent = (tagData.PV || 0).toFixed(1);\n        document.getElementById('displayUnit').textContent = tagData.und || '';\n        \n        // Cargar valores de alarma\n        document.getElementById('inputHH').value = tagData.HH || 0;\n        document.getElementById('inputH').value = tagData.H || 0;\n        document.getElementById('inputL').value = tagData.L || 0;\n        document.getElementById('inputLL').value = tagData.LL || 0;\n        \n        // Cargar estados de habilitación\n        document.getElementById('enableHH').checked = tagData.enableHH == 1;\n        document.getElementById('enableH').checked = tagData.enableH == 1;\n        document.getElementById('enableL').checked = tagData.enableL == 1;\n        document.getElementById('enableLL').checked = tagData.enableLL == 1;\n        \n        // Cargar rango\n        document.getElementById('inputMin').value = tagData.Min || 0;\n        document.getElementById('inputMax').value = tagData.Max || 100;\n        \n        // Actualizar estado de los inputs\n        toggleAlarmInput('HH');\n        toggleAlarmInput('H');\n        toggleAlarmInput('L');\n        toggleAlarmInput('LL');\n        \n        // Mostrar modal\n        document.getElementById('alarmConfigModal').classList.add('show');\n        \n        console.log('Popup abierto para:', tagData.TagName);\n    }\n    \n    // Función para cerrar el popup\n    function closeAlarmModal() {\n        document.getElementById('alarmConfigModal').classList.remove('show');\n        console.log('Popup cerrado');\n    }\n    \n    // Función para habilitar/deshabilitar inputs\n    function toggleAlarmInput(type) {\n        var checkbox = document.getElementById('enable' + type);\n        var input = document.getElementById('input' + type);\n        input.disabled = !checkbox.checked;\n    }\n    \n    // Función para guardar la configuración\n    function saveAlarmConfig() {\n        if (!currentTagData) return;\n        \n        var updatedConfig = {\n            ID: currentTagData.ID,\n            TagName: currentTagData.TagName,\n            Descripcion: currentTagData.Descripcion,\n            und: currentTagData.und,\n            PV: currentTagData.PV,\n            HH: parseFloat(document.getElementById('inputHH').value) || 0,\n            H: parseFloat(document.getElementById('inputH').value) || 0,\n            L: parseFloat(document.getElementById('inputL').value) || 0,\n            LL: parseFloat(document.getElementById('inputLL').value) || 0,\n            Max: parseFloat(document.getElementById('inputMax').value) || 0,\n            Min: parseFloat(document.getElementById('inputMin').value) || 0,\n            enableHH: document.getElementById('enableHH').checked ? 1 : 0,\n            enableH: document.getElementById('enableH').checked ? 1 : 0,\n            enableL: document.getElementById('enableL').checked ? 1 : 0,\n            enableLL: document.getElementById('enableLL').checked ? 1 : 0,\n            ALARM: currentTagData.ALARM,\n            FAIL: currentTagData.FAIL\n        };\n        \n        // Enviar mensaje a Node-RED\n        if (angularScope) {\n            angularScope.send({\n                topic: 'alarm_config_save',\n                payload: updatedConfig\n            });\n            console.log('Configuración guardada:', updatedConfig);\n        } else {\n            console.error('Error: scope no disponible');\n        }\n        \n        // Cerrar modal\n        closeAlarmModal();\n    }\n    \n    // Escuchar mensajes entrantes\n    (function(scope) {\n        angularScope = scope;  // Guardar referencia global\n        \n        scope.$watch('msg', function(msg) {\n            if (msg && msg.topic && msg.payload) {\n                \n                switch(msg.topic) {\n                    case 'open_alarm_config':\n                    case 'ALARM_CONFIG':\n                    case 'open_config':\n                        // Abrir popup con el tag recibido en payload\n                        openAlarmModal(msg.payload);\n                        break;\n                        \n                    case 'update_pv':\n                        // Actualizar PV en tiempo real si el popup está abierto\n                        if (currentTagData && msg.payload.TagName === currentTagData.TagName) {\n                            currentTagData.PV = msg.payload.PV;\n                            document.getElementById('displayPV').textContent = msg.payload.PV.toFixed(1);\n                            \n                            // Actualizar color según estado de alarma\n                            if (msg.payload.ALARM) {\n                                document.getElementById('displayPV').style.color = msg.payload.ALARM;\n                            }\n                        }\n                        break;\n                        \n                    case 'close_config':\n                        // Cerrar popup externamente\n                        closeAlarmModal();\n                        break;\n                }\n            }\n        });\n    })(scope);\n    \n    // Función de prueba con tag de ejemplo\n    window.testAlarmPopup = function() {\n        var testTag = {\n            \"ID\": 0,\n            \"TagName\": \"PIT_2001\",\n            \"Descripcion\": \"Presion de Descarga\",\n            \"und\": \"PSI\",\n            \"PV\": 45.7,\n            \"HH\": 95.0,\n            \"H\": 90.0,\n            \"L\": 15.0,\n            \"LL\": 10.0,\n            \"Max\": 560,\n            \"Min\": 0,\n            \"enableHH\": 1,\n            \"enableH\": 1,\n            \"enableL\": 1,\n            \"enableLL\": 1,\n            \"ALARM\": \"#00f800\",\n            \"FAIL\": 0\n        };\n        openAlarmModal(testTag);\n    };\n    \n    console.log('Template de alarmas cargado. Enviar: topic=\"open_alarm_config\", payload={tag object}');\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 1290,
        "y": 440,
        "wires": [
            [
                "ea9da6f09b500e72"
            ]
        ]
    },
    {
        "id": "5f2f44f7618ef7f4",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "Get TIT",
        "func": "let tag=global.get(\"PIT_2001\");\nmsg.topic = \"open_alarm_config\";\nmsg.payload=tag;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 400,
        "wires": [
            [
                "53e166a9b03ef43c"
            ]
        ]
    },
    {
        "id": "2c7dff1a7105d11e",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "Get PIT",
        "func": "let tag=global.get(\"TIT_2001\");\nmsg.topic = \"open_alarm_config\";\nmsg.payload=tag;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 440,
        "wires": [
            [
                "53e166a9b03ef43c"
            ]
        ]
    },
    {
        "id": "537f53ef822ccf6f",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "Get FIT",
        "func": "let tag=global.get(\"FIT_2001\");\nmsg.topic = \"open_alarm_config\";\nmsg.payload=tag;\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1120,
        "y": 480,
        "wires": [
            [
                "53e166a9b03ef43c"
            ]
        ]
    },
    {
        "id": "ea9da6f09b500e72",
        "type": "function",
        "z": "619addbf2da107aa",
        "name": "preparar query",
        "func": "// Verificar que viene del popup\nif (msg.topic === 'alarm_config_save') {\n    var tag = msg.payload;\n    \n    // Debug - verificar datos\n\n    \n    msg.params= {\n        $HH: tag.HH,\n        $H: tag.H,\n        $L: tag.L,\n        $LL: tag.LL,\n        $Max: tag.Max,\n        $Min: tag.Min,\n        $enableHH: tag.enableHH,\n        $enableH: tag.enableH,\n        $enableL: tag.enableL,\n        $enableLL: tag.enableLL,\n        $ID: tag.ID\n    };\n\n    global.set(tag.TagName,tag);\n    \n    return msg;\n}\nreturn null;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 440,
        "wires": [
            [
                "dfe627d839ab6604"
            ]
        ]
    },
    {
        "id": "dfe627d839ab6604",
        "type": "sqlite",
        "z": "619addbf2da107aa",
        "mydb": "8a9376f64511d022",
        "sqlquery": "prepared",
        "sql": " UPDATE tblTags SET HH = $HH, H = $H, L = $L, LL = $LL, Max = $Max, Min = $Min, enableHH = $enableHH, enableH = $enableH, enableL = $enableL, enableLL = $enableLL WHERE ID = $ID;",
        "name": "",
        "x": 1710,
        "y": 440,
        "wires": [
            [
                "833023ecbab1c9c0"
            ]
        ]
    },
    {
        "id": "83ee44d06bbae547",
        "type": "function",
        "z": "b29ed1d9bf2c7ea9",
        "name": "Flow Calc",
        "func": "const PI = Math.PI;\n    \n    // Parámetros de la tubería y placa de orificio\nconst D = 3; // Diámetro de la tubería en pulgadas\nconst d = 1.75; // Diámetro del orificio en pulgadas\nconst beta = d / D; // Relación de diámetros\n\n// Datos del transmisor multivariable\nconst P = msg.payload.presionEstatica; // Presión estática en psia\nconst dP = msg.payload.presionDiferencial; // Presión diferencial en inH2O\nconst T = msg.payload.temperatura; // Temperatura en °F\n\n// Datos actualizados de la cromatografía\nconst cromatografia = {\n    C1: 0.6631,  // Metano\n    C2: 0.1169,  // Etano\n    C3: 0.0470,  // Propano\n    iC4: 0.0077, // i-Butano\n    nC4: 0.0122, // n-Butano\n    iC5: 0.0040, // i-Pentano\n    nC5: 0.0037, // n-Pentano\n    C6: 0.0013,  // n-Hexano\n    C7: 0.0009,  // n-Heptano\n    C8: 0.0005,  // n-Octano\n    C9: 0.0003,  // n-Nonano\n    H2O: 0.0025, // Agua\n    CO2: 0.0849, // Dióxido de carbono\n    N2: 0.0547,  // Nitrógeno\n    H2S: 0.0002  // Sulfuro de hidrógeno\n};\n\n// Cálculo del peso molecular\nfunction calcularPesoMolecular(cromatografia) {\n    const pesosMoleculares = {\n        C1: 16.043, C2: 30.070, C3: 44.097,\n        iC4: 58.123, nC4: 58.123,\n        iC5: 72.150, nC5: 72.150,\n        C6: 86.177, C7: 100.204, C8: 114.231, C9: 128.258,\n        H2O: 18.015, CO2: 44.010, N2: 28.013, H2S: 34.082\n    };\n    return Object.keys(cromatografia).reduce((sum, componente) =>\n        sum + cromatografia[componente] * pesosMoleculares[componente], 0);\n}\n\nconst MW = calcularPesoMolecular(cromatografia);\n\n// Cálculo del factor de compresibilidad (Z)\n// Nota: Este es un cálculo simplificado. Para mayor precisión, se recomienda\n// usar métodos más avanzados como la ecuación de estado AGA8 o GERG-2008\nfunction calcularFactorCompresibilidad(P, T, MW) {\n    const Pc = 667 + 15 * MW - 0.05 * Math.pow(MW, 2); // Presión crítica estimada\n    const Tc = 343 + 7 * MW - 0.01 * Math.pow(MW, 2); // Temperatura crítica estimada\n    const Tr = (T + 460) / Tc; // Temperatura reducida\n    const Pr = P / Pc; // Presión reducida\n    return 1 - (0.06 + 0.01 * Pr) / Tr;\n}\n\n// Implementación simplificada del método AGA8-DC92\nfunction calcularFactorCompresibilidadAGA8(P, T, composicion) {\n    // Constantes para los componentes (orden: C1, C2, C3, iC4, nC4, iC5, nC5, N2, CO2)\n    const Tc = [190.56, 305.32, 369.83, 407.8, 425.12, 460.4, 469.7, 126.2, 304.12]; // K\n    const Pc = [45.99, 48.72, 42.48, 36.4, 37.96, 33.8, 33.7, 33.98, 73.74]; // bar\n    const omega = [0.0115, 0.0995, 0.1523, 0.1852, 0.2010, 0.2275, 0.2510, 0.0377, 0.2239];\n    \n    // Convertir temperatura a Kelvin y presión a bar\n    const Tk = (T + 459.67) * 5/9;\n    const Pbar = P * 0.0689476;\n    \n    // Calcular parámetros de mezcla\n    let Tcm = 0, Pcm = 0, omega_m = 0;\n    const componentes = ['C1', 'C2', 'C3', 'iC4', 'nC4', 'iC5', 'nC5', 'N2', 'CO2'];\n    componentes.forEach((comp, i) => {\n        const xi = composicion[comp];\n        Tcm += xi * Tc[i];\n        Pcm += xi * Pc[i];\n        omega_m += xi * omega[i];\n    });\n    \n    // Calcular factor acéntrico de mezcla\n    const omega_m_adj = 0.3796 + 1.5226 * omega_m - 0.2967 * Math.pow(omega_m, 2);\n    \n    // Calcular Z usando la ecuación de estado de Peng-Robinson\n    const R = 8.3145; // Constante de gas universal en J/(mol·K)\n    const a = 0.45724 * Math.pow(R * Tcm, 2) / Pcm * Math.pow(1 + (0.37464 + 1.54226 * omega_m_adj - 0.26992 * Math.pow(omega_m_adj, 2)) * (1 - Math.sqrt(Tk / Tcm)), 2);\n    const b = 0.0778 * R * Tcm / Pcm;\n    \n    const A = a * Pbar / Math.pow(R * Tk, 2);\n    const B = b * Pbar / (R * Tk);\n    \n    const coef = [1, -(1-B), A-3*Math.pow(B,2)-2*B, -(A*B-Math.pow(B,2)-Math.pow(B,3))];\n    \n    // Resolver la ecuación cúbica para Z\n    const roots = solveCubic(coef);\n    const Z = Math.max(...roots); // Tomar la raíz más grande\n    \n    return Z;\n}\n\n// Función auxiliar para resolver ecuaciones cúbicas\nfunction solveCubic(coef) {\n    const [a, b, c, d] = coef;\n    const p = (3*a*c - Math.pow(b,2)) / (3*Math.pow(a,2));\n    const q = (2*Math.pow(b,3) - 9*a*b*c + 27*Math.pow(a,2)*d) / (27*Math.pow(a,3));\n    const D = Math.pow(q/2,2) + Math.pow(p/3,3);\n    \n    if (D > 0) {\n        const u = Math.cbrt(-q/2 + Math.sqrt(D));\n        const v = Math.cbrt(-q/2 - Math.sqrt(D));\n        return [u + v - b/(3*a)];\n    } else if (D === 0) {\n        const u = Math.cbrt(-q/2);\n        return [2*u - b/(3*a), -u - b/(3*a)];\n    } else {\n        const phi = Math.acos(-q / (2*Math.sqrt(Math.pow(-p/3,3))));\n        const r = 2 * Math.sqrt(-p/3);\n        return [\n            r * Math.cos(phi/3) - b/(3*a),\n            r * Math.cos((phi + 2*Math.PI)/3) - b/(3*a),\n            r * Math.cos((phi + 4*Math.PI)/3) - b/(3*a)\n        ];\n    }\n}\n\n// Usar el nuevo método AGA8 para calcular Z\nconst Z = calcularFactorCompresibilidadAGA8(P, T, cromatografia);\n\n// Función actualizada para calcular Cd usando el número de Reynolds\nfunction calcularCd(beta, D, P, dP, Re) {\n    // Esta es una versión simplificada. La ecuación completa es más compleja.\n    const L1 = 0.0254 / D; // Asumiendo una toma de presión en la esquina\n    const L2 = 0.0254 / D;\n    const A = Math.pow(19000 * beta / Re, 0.8);\n    \n    return 0.5961 + 0.0261 * Math.pow(beta, 2) - 0.216 * Math.pow(beta, 8) +\n           0.000521 * Math.pow(1e6 * beta / Re, 0.7) +\n           (0.0188 + 0.0063 * A) * Math.pow(beta, 3.5) * Math.pow(1e6 / Re, 0.3) +\n           (0.043 + 0.080 * Math.exp(-10 * L1) - 0.123 * Math.exp(-7 * L1)) * \n           (1 - 0.11 * A) * Math.pow(beta, 4) / (1 - Math.pow(beta, 4)) -\n           0.031 * (L2 - 0.8 * Math.pow(L2, 1.1)) * Math.pow(beta, 1.3);\n}\n\n\n// Función para calcular el número de Reynolds\nfunction Reynolds(D, P, T, MW, dP, Z) {\n    const mu = 1.8e-5; // Viscosidad dinámica estimada en Pa·s\n    const rho = P * MW / (Z * 10.73 * (T + 460)); // Densidad del gas en lb/ft³\n    const velocidad = 0.0119 * Math.sqrt(dP * P / (MW * (T + 460))); // Velocidad en ft/s\n    return 7000 * rho * velocidad * D / mu; // Reynolds (adimensional)\n}\n\n\n\nconst Re = Reynolds(D, P, T, MW, dP, Z);\nconst Cd = calcularCd(beta, D, P, dP, Re);\n\n// Cálculo del factor de expansión\nconst Y = 1 - (0.41 + 0.35 * Math.pow(beta, 4)) * (dP / (P * 27.7076));\n\n// Cálculo del flujo másico\nconst Qm = 359 * Cd * Y * Math.pow(d, 2) * Math.sqrt(dP * P * MW / ((T + 460) * Z));\n\n// Cálculo del flujo volumétrico a condiciones de proceso\nconst Qv = Qm * (Z * 10.73 * (T + 460)) / (MW * P);\n\n// Asignamos el resultado al payload\nmsg.payload = {\n    flujoMasico: Qm, // en lb/h\n    flujoVolumetrico: Qv, // en ft³/h a condiciones de proceso\n    pesoMolecular: MW,\n    factorCompresibilidad: Z,\n    coeficienteDescarga: Cd\n};\n    \nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 220,
        "wires": [
            [
                "5c4351fcc7cd9285"
            ]
        ]
    },
    {
        "id": "99caf9430ccab308",
        "type": "function",
        "z": "b29ed1d9bf2c7ea9",
        "name": "Load MV",
        "func": " msg.payload={\n    \"presionEstatica\": 800,\n    \"presionDiferencial\" : 125.0,\n    \"temperatura\":80.12\n }\n \n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 220,
        "wires": [
            [
                "83ee44d06bbae547"
            ]
        ]
    },
    {
        "id": "5c4351fcc7cd9285",
        "type": "debug",
        "z": "b29ed1d9bf2c7ea9",
        "name": "debug 11",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 760,
        "y": 220,
        "wires": []
    },
    {
        "id": "978306859f254413",
        "type": "inject",
        "z": "b29ed1d9bf2c7ea9",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 220,
        "wires": [
            [
                "99caf9430ccab308"
            ]
        ]
    },
    {
        "id": "4dfbb168def9e801",
        "type": "function",
        "z": "33c28a10b022eebb",
        "name": "function 4",
        "func": "var coilAddress = 0;\n\nif (global.get(\"START_BATCH\")==true) {\n    coilAddress = 0;  // Iniciar\n    global.set(\"START_BATCH\",false);\n    global.set(\"STATUS_BATCH\", \"ACTIVO\");\n    \n} else if (global.get(\"STOP_BATCH\")==true) {\n    coilAddress = 1;  // Parar\n    global.set(\"STOP_BATCH\",false);\n    global.set(\"STATUS_BATCH\", \"PAUSADO\");\n} else if (global.get(\"CLEAR_BATCH\")==true) {\n    coilAddress = 2;  // Borrar\n    global.set(\"CLEAR_BATCH\",false);\n    global.set(\"STATUS_BATCH\", \"LISTO\");\n}else {\n    msg.payload=null;\n    \n}\n\nif(msg.payload!=null)\n{\n        // Preparar mensaje para Modbus Write\n    msg.payload = {\n        'value': true,\n        'fc': 5,  // Function Code 5: Write Single Coil\n        'unitid': 1,\n        'address': coilAddress,\n        'quantity': 1 \n    };\n\n}\n\n\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 540,
        "y": 280,
        "wires": [
            [
                "c58dc7a7fda31044"
            ]
        ]
    },
    {
        "id": "20a6434651bedcad",
        "type": "modbus-flex-write",
        "z": "33c28a10b022eebb",
        "name": "Force coils",
        "showStatusActivities": true,
        "showErrors": true,
        "showWarnings": true,
        "server": "c2bd2524a791d21d",
        "emptyMsgOnFail": false,
        "keepMsgProperties": false,
        "delayOnStart": false,
        "startDelayTime": "",
        "x": 910,
        "y": 280,
        "wires": [
            [],
            [
                "73f537ef172e2f75"
            ]
        ]
    },
    {
        "id": "c58dc7a7fda31044",
        "type": "switch",
        "z": "33c28a10b022eebb",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "null"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 280,
        "wires": [
            [
                "20a6434651bedcad"
            ],
            []
        ]
    },
    {
        "id": "0c86295d17891846",
        "type": "inject",
        "z": "33c28a10b022eebb",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "1",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 360,
        "y": 280,
        "wires": [
            [
                "4dfbb168def9e801"
            ]
        ]
    },
    {
        "id": "73f537ef172e2f75",
        "type": "debug",
        "z": "33c28a10b022eebb",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1160,
        "y": 300,
        "wires": []
    }
]